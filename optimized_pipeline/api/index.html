<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î≤àÏó≠ÌíàÏßà Í≤ÄÏÇ¨Í∏∞ | MT Quality Analytics</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Ï£ºÏãù ÏõπÏÇ¨Ïù¥Ìä∏ Ïª¨Îü¨ ÌåîÎ†àÌä∏ */
            --primary-bg: #0a0e1a;
            --secondary-bg: #1a1f2e;
            --card-bg: #252d3d;
            --accent-bg: #2a3441;
            --success-color: #00d084;
            --danger-color: #ff6b6b;
            --warning-color: #ffa726;
            --info-color: #42a5f5;
            --neutral-color: #6c757d;
            --text-primary: #ffffff;
            --text-secondary: #b3bcc8;
            --text-muted: #8b949e;
            --border-color: #30374a;
            --shadow-light: rgba(0, 0, 0, 0.1);
            --shadow-medium: rgba(0, 0, 0, 0.25);
            --gradient-success: linear-gradient(135deg, #00d084, #00c477);
            --gradient-danger: linear-gradient(135deg, #ff6b6b, #ff5252);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--primary-bg);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 14px;
            min-height: 100vh;
        }

        .main-header {
            background: var(--secondary-bg);
            border-bottom: 1px solid var(--border-color);
            padding: 16px 24px;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            background: var(--gradient-success);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 14px;
            color: var(--text-muted);
            font-weight: 400;
        }

        .header-stats {
            display: flex;
            gap: 24px;
            align-items: center;
        }

        .stat-item {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 16px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            min-width: 120px;
        }

        .stat-item:hover {
            border-color: var(--success-color);
            background: var(--accent-bg);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 208, 132, 0.2);
        }

        .stat-item::before {
            content: 'üìä';
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--success-color);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.3s ease;
        }

        .stat-item:hover::before {
            opacity: 1;
            transform: scale(1);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1;
        }

        .stat-subtext {
            font-size: 10px;
            color: var(--text-secondary);
            margin-top: 4px;
            opacity: 0.8;
        }
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        .sidebar {
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            overflow: hidden;
            height: fit-content;
        }

        .main-content {
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            overflow: visible;
        }

        .nav-section {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .nav-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 4px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .nav-item:hover {
            background: var(--accent-bg);
            color: var(--text-primary);
        }

        .nav-item.active {
            background: var(--success-color);
            color: white;
            font-weight: 500;
        }

        .search-section {
            padding: 20px;
        }

        .search-box {
            position: relative;
            margin-bottom: 16px;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 16px;
            background: var(--accent-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.2s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: var(--success-color);
            box-shadow: 0 0 0 3px rgba(0, 208, 132, 0.1);
        }

        input[type="text"]::placeholder {
            color: var(--text-muted);
        }

        .filter-group {
            margin-bottom: 16px;
        }

        .filter-label {
            display: block;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 12px;
            background: var(--accent-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        /* Î≤îÏúÑ Ïä¨ÎùºÏù¥Îçî Ïä§ÌÉÄÏùº */
        .range-filter {
            margin-bottom: 16px;
        }

        .range-slider-container {
            position: relative;
            margin: 12px 0;
        }

        .dual-range-slider {
            position: relative;
            height: 6px;
            background: var(--accent-bg);
            border-radius: 3px;
            margin: 20px 0;
        }

        .dual-range-slider input[type="range"] {
            position: absolute;
            width: 100%;
            height: 6px;
            background: transparent;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            pointer-events: none;
        }

        .dual-range-slider input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--success-color);
            cursor: pointer;
            border: 2px solid var(--secondary-bg);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            pointer-events: all;
        }

        .dual-range-slider input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--success-color);
            cursor: pointer;
            border: 2px solid var(--secondary-bg);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            pointer-events: all;
        }

        .range-track {
            position: absolute;
            height: 6px;
            background: var(--success-color);
            border-radius: 3px;
            top: 0;
        }

        .range-values {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 8px;
        }

        .range-current {
            font-size: 12px;
            color: var(--success-color);
            font-weight: 500;
            text-align: center;
            margin-top: 4px;
        }

        .delta-toggle {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .toggle-btn {
            flex: 1;
            padding: 6px 8px;
            background: var(--accent-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-secondary);
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .toggle-btn:hover,
        .toggle-btn.active {
            background: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .content-header {
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .content-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .view-controls {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn {
            padding: 10px 16px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--accent-bg);
            color: var(--text-secondary);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: var(--secondary-bg);
            color: var(--text-primary);
            border-color: var(--success-color);
        }

        .btn.primary {
            background: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .btn.primary:hover {
            background: #00c477;
        }

        /* Ï£ºÏãù Ïä§ÌÉÄÏùº Î†àÏΩîÎìú Ïπ¥Îìú */
        .record-grid {
            padding: 24px;
        }

        .record-card {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 16px;
            overflow: visible;
            transition: all 0.2s;
        }

        .record-card:hover {
            border-color: var(--success-color);
            box-shadow: 0 4px 12px rgba(0, 208, 132, 0.1);
        }

        .record-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .record-id {
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            color: var(--text-muted);
            background: var(--accent-bg);
            padding: 4px 8px;
            border-radius: 4px;
        }

        .quality-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .quality-badge-improved {
            display: flex;
            align-items: center;
            gap: 6px;
            flex-wrap: wrap;
        }

        .quality-badge-original {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            opacity: 0.7;
            position: relative;
        }

        .quality-badge-original::before {
            content: 'Í∏∞Ï°¥: ';
            font-size: 9px;
            opacity: 0.8;
        }

        .quality-improvement-arrow {
            color: var(--success-color);
            font-size: 14px;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        .quality-badge-mini {
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            display: inline-block;
        }

        .quality-badge-mini.quality-excellent {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .quality-badge-mini.quality-very-good {
            background: rgba(132, 204, 22, 0.2);
            color: #84cc16;
            border: 1px solid rgba(132, 204, 22, 0.3);
        }

        .quality-badge-mini.quality-good {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .quality-badge-mini.quality-poor {
            background: rgba(249, 115, 22, 0.2);
            color: #f97316;
            border: 1px solid rgba(249, 115, 22, 0.3);
        }

        .quality-badge-mini.quality-very-poor {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .quality-excellent {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .quality-very-good {
            background: rgba(132, 204, 22, 0.2);
            color: #84cc16;
            border: 1px solid rgba(132, 204, 22, 0.3);
        }

        .quality-good {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .quality-poor {
            background: rgba(249, 115, 22, 0.2);
            color: #f97316;
            border: 1px solid rgba(249, 115, 22, 0.3);
        }

        .quality-very-poor {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        /* Ï£ºÏãù Ïä§ÌÉÄÏùº Ï†êÏàò ÏÑπÏÖò */
        .scores-section {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .score-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            text-align: center;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.2s;
        }

        .score-card:hover {
            border-color: var(--success-color);
            transform: translateY(-2px);
        }

        .score-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--neutral-color);
        }

        .score-card.improvement::before {
            background: var(--gradient-success);
        }

        .score-card.decline::before {
            background: var(--gradient-danger);
        }

        .score-label {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .score-main {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .score-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .score-change {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 14px;
            font-weight: 600;
        }

        .score-arrow {
            font-size: 16px;
        }

        .score-positive {
            color: var(--success-color);
        }

        .score-negative {
            color: var(--danger-color);
        }

        .score-neutral {
            color: var(--neutral-color);
        }

        .score-percentage {
            font-size: 12px;
            color: var(--text-muted);
        }

        .score-gauge {
            height: 4px;
            background: var(--accent-bg);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 12px;
        }

        .score-fill {
            height: 100%;
            background: var(--success-color);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* ÌÖçÏä§Ìä∏ diff Ïä§ÌÉÄÏùº */
        .text-section {
            padding: 20px;
            border-top: 1px solid var(--border-color);
        }

        .text-row {
            margin-bottom: 16px;
        }

        .text-label {
            font-size: 12px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .text-content {
            background: var(--accent-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-primary);
        }

        .text-diff {
            position: relative;
        }

        .diff-original {
            background: rgba(255, 107, 107, 0.15);
            color: #ff8a80;
            padding: 2px 4px;
            border-radius: 3px;
            text-decoration: line-through;
            margin-right: 4px;
        }

        .diff-improved {
            background: rgba(0, 208, 132, 0.15);
            color: #4ade80;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 500;
        }

        /* APE Í∞úÏÑ† ÌëúÏãú */
        .ape-improvement {
            background: var(--card-bg);
            border: 1px solid rgba(0, 208, 132, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin-top: 12px;
        }

        .ape-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .ape-icon {
            color: var(--success-color);
            font-size: 16px;
        }

        .ape-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--success-color);
        }

        /* Ìà¥ÌåÅ Ïä§ÌÉÄÏùº */
        .tooltip {
            position: absolute;
            background: var(--secondary-bg);
            color: var(--text-primary);
            padding: 16px;
            border-radius: 8px;
            font-size: 12px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s;
            max-width: 320px;
            line-height: 1.4;
        }

        .tooltip.show {
            opacity: 1;
            visibility: visible;
        }

        .tooltip-header {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--success-color);
        }

        .tooltip-section {
            margin-bottom: 8px;
        }

        .tooltip-label {
            font-weight: 500;
            color: var(--text-secondary);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .tooltip-value {
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        /* Evidence ÌëúÏãú Ïä§ÌÉÄÏùº */
        .evidence-indicator {
            position: relative;
            display: inline-block;
            margin-left: 8px;
            cursor: pointer;
        }

        .evidence-icon {
            background: var(--warning-color);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
        }

        .evidence-icon.critical {
            background: var(--danger-color);
        }

        .evidence-icon.info {
            background: var(--info-color);
        }

        .evidence-tooltip {
            position: fixed;
            background: var(--secondary-bg);
            color: var(--text-primary);
            padding: 16px;
            border-radius: 8px;
            font-size: 12px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            z-index: 1001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s;
            min-width: 200px;
            max-width: 400px;
            width: auto;
            word-wrap: break-word;
            white-space: normal;
            line-height: 1.4;
            pointer-events: none;
        }

        .evidence-tooltip.show {
            opacity: 1;
            visibility: visible;
        }

        .score-info-btn {
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 12px;
            margin-left: 4px;
            transition: color 0.2s;
        }

        .score-info-btn:hover {
            color: var(--success-color);
        }

        .load-more-section {
            padding: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid var(--border-color);
            background: var(--secondary-bg);
            position: relative;
        }

        .load-more-section .btn.primary {
            position: fixed;
            bottom: 24px;
            right: 24px;
            border-radius: 50px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            z-index: 100;
            font-size: 14px;
            padding: 12px 20px;
        }

        .scroll-to-top {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            color: var(--text-muted);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            z-index: 99;
            opacity: 0;
            visibility: hidden;
        }

        .scroll-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .scroll-to-top:hover {
            background: var(--success-color);
            color: white;
            transform: translateX(-50%) translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 208, 132, 0.3);
        }

        .record-count-info {
            margin-top: 12px;
            font-size: 13px;
            color: var(--text-muted);
            text-align: center;
            flex: 1;
        }

        .record-count-info span {
            font-weight: 600;
            color: var(--text-secondary);
        }

        /* Ïä§ÌÅ¨Î°§ Ìà¨ ÌÉë Î≤ÑÌäº */
        .scroll-to-top {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            color: var(--text-muted);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            z-index: 99;
            opacity: 0;
            visibility: hidden;
        }

        .scroll-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .scroll-to-top:hover {
            background: var(--success-color);
            color: white;
            transform: translateX(-50%) translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 208, 132, 0.3);
        }

        /* ÌÜµÍ≥Ñ Ï∞®Ìä∏ Î™®Îã¨ */
        .stats-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .stats-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .stats-modal-content {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 32px;
            max-width: 800px;
            width: 90%;
            max-height: 90%;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .stats-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .stats-modal-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .stats-modal-close {
            background: transparent;
            border: none;
            font-size: 24px;
            color: var(--text-muted);
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .stats-modal-close:hover {
            background: var(--accent-bg);
            color: var(--text-primary);
        }

        /* Ïä§ÏΩîÏñ¥ Ï†ïÎ≥¥ Î™®Îã¨ */
        .score-info-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .score-info-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .score-info-modal-content {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 0;
            max-width: 600px;
            width: 90%;
            max-height: 85%;
            overflow: hidden;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .score-info-header {
            background: linear-gradient(135deg, var(--success-color), #4ade80);
            color: white;
            padding: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .score-info-title {
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .score-info-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .score-info-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .score-info-body {
            padding: 24px;
            overflow-y: auto;
            max-height: 60vh;
        }

        .score-current-value {
            background: var(--accent-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin-bottom: 24px;
        }

        .score-current-value .value {
            font-size: 36px;
            font-weight: 700;
            color: var(--success-color);
            margin-bottom: 8px;
        }

        .score-current-value .label {
            font-size: 14px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .score-section {
            margin-bottom: 24px;
        }

        .score-section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .score-section-content {
            background: var(--accent-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        .score-improvement-info {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(34, 197, 94, 0.1));
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .score-improvement-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--info-color);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .score-improvement-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 16px;
        }

        .score-improvement-item {
            text-align: center;
        }

        .score-improvement-item .value {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .score-improvement-item .value.positive {
            color: var(--success-color);
        }

        .score-improvement-item .value.negative {
            color: #ef4444; /* Îπ®Í∞ÑÏÉâ */
        }

        .score-improvement-item .label {
            font-size: 12px;
            color: var(--text-muted);
        }

        .quality-scale {
            background: var(--accent-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }

        .quality-scale-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .quality-scale-item:last-child {
            border-bottom: none;
        }

        .quality-scale-range {
            font-weight: 600;
            color: var(--text-primary);
        }

        .quality-scale-description {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .score-interpretation-guide {
            background: var(--accent-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
        }

        .interpretation-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .interpretation-icon {
            font-size: 20px;
            color: var(--info-color);
        }

        .interpretation-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .interpretation-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.2s ease;
        }

        .interpretation-item:last-child {
            border-bottom: none;
        }

        .interpretation-item:hover {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 12px 8px;
            margin: 0 -8px;
        }

        .interpretation-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-top: 4px;
            flex-shrink: 0;
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.3);
        }

        .interpretation-indicator.excellent {
            background: linear-gradient(135deg, #22c55e, #16a34a);
        }

        .interpretation-indicator.very-good {
            background: linear-gradient(135deg, #84cc16, #65a30d);
        }

        .interpretation-indicator.good {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
        }

        .interpretation-indicator.poor {
            background: linear-gradient(135deg, #f97316, #ea580c);
        }

        .interpretation-indicator.very-poor {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .interpretation-content {
            flex: 1;
        }

        .interpretation-range {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .interpretation-description {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .usage-guide {
            background: linear-gradient(135deg, rgba(66, 165, 245, 0.1), rgba(30, 64, 175, 0.1));
            border: 1px solid rgba(66, 165, 245, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
        }

        .usage-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .usage-icon {
            font-size: 18px;
            color: var(--info-color);
        }

        .usage-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--info-color);
        }

        .usage-content {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .score-method {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(109, 40, 217, 0.1));
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
        }

        .method-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .method-icon {
            font-size: 18px;
            color: #a855f7;
        }

        .method-title {
            font-size: 16px;
            font-weight: 600;
            color: #a855f7;
        }

        .method-content {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .chart-container {
            width: 100%;
            height: 400px;
            margin-bottom: 24px;
            position: relative;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .chart-stat {
            background: var(--accent-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .chart-stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--success-color);
            margin-bottom: 8px;
        }

        .chart-stat-label {
            font-size: 14px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .chart-stat-desc {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 8px;
            line-height: 1.4;
        }

        /* Í∞ÑÎã®Ìïú Î∞î Ï∞®Ìä∏ Ïä§ÌÉÄÏùº */
        .simple-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 320px;
            padding: 24px 20px 40px 20px; /* ÌïòÎã® Ìå®Îî© Ï¶ùÍ∞Ä (ÎùºÎ≤® Í≥µÍ∞Ñ) */
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--card-bg);
            gap: 20px;
            position: relative;
        }

        .chart-bar {
            display: flex;
            flex-direction: column;
            align-self: flex-end;
            align-items: center;
            max-width: 120px; /* ÎÑàÎπÑ Ï¶ùÍ∞Ä */
            flex: 1;
            position: relative;
        }

        .bar {
            width: 100%;
            border-radius: 8px 8px 0 0;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding-top: 8px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
            min-height: 0; /* ÏµúÏÜå ÎÜíÏù¥ Ï†úÍ±∞ */
        }

        .bar:hover {
            opacity: 0.9;
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 4px 16px rgba(0,0,0,0.25);
        }

        .bar-value {
            color: white;
            font-size: 13px;
            font-weight: 700;
            text-shadow: 0 1px 2px rgba(0,0,0,0.7);
            background: rgba(0,0,0,0.3);
            padding: 4px 8px;
            border-radius: 4px;
            backdrop-filter: blur(2px);
            white-space: nowrap;
        }

        .bar-label {
            font-size: 12px;
            color: var(--text-primary);
            text-align: center;
            font-weight: 500;
            line-height: 1.2;
            position: absolute;
            bottom: -35px; /* ÎùºÎ≤®ÏùÑ Î∞î ÏïÑÎûòÎ°ú ÏúÑÏπò */
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
        }

        /* ÎèÑÎÑõ Ï∞®Ìä∏ Ïä§ÌÉÄÏùº */
        .donut-chart {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 300px;
            position: relative;
        }

        .donut-svg {
            width: 200px;
            height: 200px;
        }

        .donut-legend {
            margin-left: 40px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
            margin-right: 12px;
        }

        .legend-label {
            font-size: 14px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .legend-value {
            font-size: 12px;
            color: var(--text-muted);
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .scores-section {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
            
            .header-stats {
                gap: 12px;
            }
            
            .stat-item {
                min-width: 80px;
                padding: 12px 16px;
            }
            
            .stat-value {
                font-size: 20px;
            }
            
            .stat-label {
                font-size: 10px;
            }
            
            .stat-subtext {
                font-size: 8px;
            }

            .stats-modal-content {
                margin: 20px;
                padding: 20px;
                max-width: none;
                width: auto;
            }

            .chart-grid {
                grid-template-columns: 1fr;
            }

            .donut-chart {
                flex-direction: column;
                height: auto;
            }

            .donut-legend {
                margin-left: 0;
                margin-top: 20px;
            }
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
            color: var(--text-muted);
        }

        .spinner {
            width: 32px;
            height: 32px;
            border: 3px solid var(--accent-bg);
            border-top: 3px solid var(--success-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 12px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo">Î≤àÏó≠ÌíàÏßà Í≤ÄÏÇ¨Í∏∞</div>
                <div class="subtitle">MT Quality Analytics</div>
            </div>
            <div class="header-stats" id="headerStats">
                <div class="stat-item" onclick="showStatsChart('records')">
                    <div class="stat-label">Ï¥ù Î†àÏΩîÎìú</div>
                    <div class="stat-value" id="totalRecords">-</div>
                    <div class="stat-subtext">ÌÅ¥Î¶≠ÌïòÏó¨ Ï∞®Ìä∏ Î≥¥Í∏∞</div>
                </div>
                <div class="stat-item" onclick="showStatsChart('pass-rate')">
                    <div class="stat-label">ÌÜµÍ≥ºÏú®</div>
                    <div class="stat-value" id="passRate">-</div>
                    <div class="stat-subtext">ÌÅ¥Î¶≠ÌïòÏó¨ Ï∞®Ìä∏ Î≥¥Í∏∞</div>
                </div>
                <div class="stat-item" onclick="showStatsChart('ape-effect')">
                    <div class="stat-label">APE Í∞úÏÑ†Ïú®</div>
                    <div class="stat-value" id="apeEffectiveness">-</div>
                    <div class="stat-subtext">ÌÅ¥Î¶≠ÌïòÏó¨ Ï∞®Ìä∏ Î≥¥Í∏∞</div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="dashboard-grid">
            <aside class="sidebar">
                <div class="nav-section">
                    <div class="nav-title">Î∂ÑÏÑù ÎèÑÍµ¨</div>
                    <div class="nav-item active" data-view="all">
                        <span>ÔøΩ</span> Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞
                    </div>
                    <div class="nav-item" data-view="high-quality">
                        <span>‚≠ê</span> Í≥†ÌíàÏßà Î≤àÏó≠
                    </div>
                    <div class="nav-item" data-view="failed">
                        <span>‚ö†</span> ÌíàÏßà ÎØ∏Îã¨
                    </div>
                    <div class="nav-item" data-view="ape-improved">
                        <span>‚ú®</span> APE Í∞úÏÑ†ÏÇ¨Î°Ä
                    </div>
                </div>

                <div class="search-section">
                    <div class="search-box">
                        <select id="searchType" style="width: 100%; padding: 8px 12px; background: var(--accent-bg); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-secondary); font-size: 12px; margin-bottom: 8px;">
                            <option value="all">Ï†ÑÏ≤¥ ÌïÑÎìú Í≤ÄÏÉâ</option>
                            <option value="key">Key Í≤ÄÏÉâ</option>
                            <option value="src">ÏõêÎ¨∏ Í≤ÄÏÉâ</option>
                            <option value="mt">Í∏∞Í≥ÑÎ≤àÏó≠ Í≤ÄÏÉâ</option>
                            <option value="ape">APE Í≤ÄÏÉâ</option>
                        </select>
                        <input type="text" id="searchInput" placeholder="Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî...">
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">ÌíàÏßà Îì±Í∏â</label>
                        <div class="filter-buttons">
                            <button class="filter-btn active" data-filter="all">Ï†ÑÏ≤¥</button>
                            <button class="filter-btn" data-filter="excellent">Îß§Ïö∞Ïö∞Ïàò</button>
                            <button class="filter-btn" data-filter="very-good">Ïö∞Ïàò</button>
                            <button class="filter-btn" data-filter="good">ÏñëÌò∏</button>
                            <button class="filter-btn" data-filter="poor">ÎÇòÏÅ®</button>
                            <button class="filter-btn" data-filter="very-poor">Îß§Ïö∞ÎÇòÏÅ®</button>
                        </div>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">ÌÖçÏä§Ìä∏ Í∏∏Ïù¥</label>
                        <div class="filter-buttons">
                            <button class="filter-btn active" data-bucket="all">Ï†ÑÏ≤¥</button>
                            <button class="filter-btn" data-bucket="very_short">Îß§Ïö∞ÏßßÏùå</button>
                            <button class="filter-btn" data-bucket="short">ÏßßÏùå</button>
                            <button class="filter-btn" data-bucket="medium">Î≥¥ÌÜµ</button>
                            <button class="filter-btn" data-bucket="long">ÍπÄ</button>
                            <button class="filter-btn" data-bucket="very_long">Îß§Ïö∞ÍπÄ</button>
                        </div>
                    </div>

                    <div class="range-filter">
                        <label class="filter-label">GEMBA Ï†êÏàò</label>
                        <div class="range-slider-container">
                            <div class="dual-range-slider">
                                <div class="range-track" id="gembaTrack"></div>
                                <input type="range" id="gembaMin" min="0" max="100" value="0" step="1">
                                <input type="range" id="gembaMax" min="0" max="100" value="100" step="1">
                            </div>
                            <div class="range-values">
                                <span>0</span>
                                <span>100</span>
                            </div>
                            <div class="range-current" id="gembaRangeCurrent">Ï†ÑÏ≤¥ Î≤îÏúÑ (0 ~ 100)</div>
                        </div>
                    </div>

                    <div class="range-filter">
                        <label class="filter-label">COMET Ï†êÏàò</label>
                        <div class="range-slider-container">
                            <div class="dual-range-slider">
                                <div class="range-track" id="cometTrack"></div>
                                <input type="range" id="cometMin" min="0" max="100" value="0" step="1">
                                <input type="range" id="cometMax" min="0" max="100" value="100" step="1">
                            </div>
                            <div class="range-values">
                                <span>0.0</span>
                                <span>1.0</span>
                            </div>
                            <div class="range-current" id="cometRangeCurrent">Ï†ÑÏ≤¥ Î≤îÏúÑ (0.00 ~ 1.00)</div>
                        </div>
                    </div>

                    <div class="range-filter">
                        <label class="filter-label">COS Ï†êÏàò</label>
                        <div class="range-slider-container">
                            <div class="dual-range-slider">
                                <div class="range-track" id="cosTrack"></div>
                                <input type="range" id="cosMin" min="0" max="100" value="0" step="1">
                                <input type="range" id="cosMax" min="0" max="100" value="100" step="1">
                            </div>
                            <div class="range-values">
                                <span>0.0</span>
                                <span>1.0</span>
                            </div>
                            <div class="range-current" id="cosRangeCurrent">Ï†ÑÏ≤¥ Î≤îÏúÑ (0.00 ~ 1.00)</div>
                        </div>
                    </div>

                    <div class="range-filter">
                        <label class="filter-label">Í∞úÏÑ†ÎèÑ</label>
                        <div class="delta-toggle">
                            <button class="toggle-btn active" data-delta="comet">COMET Í∞úÏÑ†</button>
                            <button class="toggle-btn" data-delta="cos">COS Í∞úÏÑ†</button>
                        </div>
                        <div class="range-slider-container">
                            <div class="dual-range-slider">
                                <div class="range-track" id="deltaTrack"></div>
                                <input type="range" id="deltaMin" min="-50" max="50" value="-50" step="1">
                                <input type="range" id="deltaMax" min="-50" max="50" value="50" step="1">
                            </div>
                            <div class="range-values">
                                <span>-0.5</span>
                                <span>+0.5</span>
                            </div>
                            <div class="range-current" id="deltaRangeCurrent">Ï†ÑÏ≤¥ Î≤îÏúÑ (-0.50 ~ +0.50)</div>
                        </div>
                    </div>
                </div>
            </aside>

            <main class="main-content">
                <div class="content-header">
                    <div class="content-title" id="contentTitle">Ï†ÑÏ≤¥ Î≤àÏó≠ÌíàÏßà ÌòÑÌô©</div>
                    <div class="view-controls">
                        <button class="btn" onclick="refreshData()">
                            <span>‚Üª</span> ÏÉàÎ°úÍ≥†Ïπ®
                        </button>
                        <button class="btn primary" onclick="exportData()">
                            <span>‚¨á</span> Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞
                        </button>
                    </div>
                </div>

                <div class="record-grid" id="recordGrid">
                    <div class="loading">
                        <div class="spinner"></div>
                        Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ë...
                    </div>
                </div>

                <div id="loadMoreSection" class="load-more-section" style="display: none;">
                    <div class="record-count-info">
                        ÌòÑÏû¨ <span id="currentCount">0</span>Í∞ú / Ï†ÑÏ≤¥ <span id="totalCount">0</span>Í∞ú ÌëúÏãúÏ§ë
                    </div>
                    <button class="btn primary" id="loadMoreBtn" onclick="loadMoreRecords()">
                        <span>‚ãØ</span> ÎçîÎ≥¥Í∏∞
                    </button>
                </div>
            </main>
        </div>
    </div>

    <!-- Ïä§ÌÅ¨Î°§ Ìà¨ ÌÉë Î≤ÑÌäº -->
    <div class="scroll-to-top" id="scrollToTop" onclick="scrollToTop()">
        ‚Üë
    </div>

    <!-- ÌÜµÍ≥Ñ Ï∞®Ìä∏ Î™®Îã¨ -->
    <div class="stats-modal" id="statsModal">
        <div class="stats-modal-content">
            <div class="stats-modal-header">
                <div class="stats-modal-title" id="modalTitle">ÌÜµÍ≥Ñ Î∂ÑÏÑù</div>
                <button class="stats-modal-close" onclick="closeStatsModal()">√ó</button>
            </div>
            <div id="modalContent">
                <!-- Ï∞®Ìä∏ ÎÇ¥Ïö©Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÇΩÏûÖÎê©ÎãàÎã§ -->
            </div>
        </div>
    </div>

    <!-- Ïä§ÏΩîÏñ¥ Ï†ïÎ≥¥ Î™®Îã¨ -->
    <div class="score-info-modal" id="scoreInfoModal">
        <div class="score-info-modal-content">
            <div class="score-info-header">
                <div class="score-info-title">
                    üìä <span id="scoreModalTitle">Ï†êÏàò ÏÉÅÏÑ∏ Ï†ïÎ≥¥</span>
                </div>
                <button class="score-info-close" onclick="closeScoreInfoModal()">√ó</button>
            </div>
            <div class="score-info-body">
                <div class="score-current-value">
                    <div class="value" id="scoreCurrentValue">85.2</div>
                    <div class="label" id="scoreCurrentLabel">GEMBA SCORE</div>
                </div>

                <div class="score-improvement-info" id="scoreImprovementInfo" style="display: none;">
                    <div class="score-improvement-title">
                        üìà Í∞úÏÑ† Î∂ÑÏÑù Í≤∞Í≥º
                    </div>
                    <div class="score-improvement-details">
                        <div class="score-improvement-item">
                            <div class="value positive" id="deltaValue">+12.3</div>
                            <div class="label">Í∞úÏÑ† Ï†ïÎèÑ</div>
                        </div>
                        <div class="score-improvement-item">
                            <div class="value" id="beforeValue">72.9</div>
                            <div class="label">ÏõêÎ≥∏ Ï†êÏàò</div>
                        </div>
                        <div class="score-improvement-item">
                            <div class="value" id="afterValue">85.2</div>
                            <div class="label">Í∞úÏÑ† ÌõÑ Ï†êÏàò</div>
                        </div>
                    </div>
                </div>

                <div class="score-section">
                    <div class="score-section-title">
                        üìè ÌíàÏßà ÌèâÍ∞Ä Í∏∞Ï§Ä
                    </div>
                    <div class="score-section-content">
                        <div class="quality-scale" id="qualityScale">
                            <!-- ÌíàÏßà Í∏∞Ï§ÄÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                        </div>
                    </div>
                </div>

                <div class="score-section">
                    <div class="score-section-title">
                        üìñ Ï†êÏàò Ìï¥ÏÑù Í∞ÄÏù¥Îìú
                    </div>
                    <div class="score-section-content" id="scoreInterpretation">
                        <!-- Ï†êÏàò Ìï¥ÏÑù ÎÇ¥Ïö©Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                    </div>
                </div>

                <div class="score-section">
                    <div class="score-section-title">
                        üí° ÌèâÍ∞Ä Î∞©Î≤ï
                    </div>
                    <div class="score-section-content" id="evaluationMethod">
                        <!-- ÌèâÍ∞Ä Î∞©Î≤ï ÏÑ§Î™ÖÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';
        let currentData = [];
        let allData = []; // Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
        let displayLimit = 10; // ÌòÑÏû¨ ÌëúÏãú Í∞úÏàò
        let currentFilters = {
            view: 'all',
            quality: 'all',
            bucket: 'all',
            search: '',
            searchType: 'all',
            ranges: {
                gemba: { min: 0, max: 100, enabled: false },
                comet: { min: 0, max: 1, enabled: false },
                cos: { min: 0, max: 1, enabled: false },
                delta: { min: -0.5, max: 0.5, enabled: false, type: 'comet' }
            }
        };

        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            loadHeaderStats();
            loadRecords();
            setupEventListeners();
            setupScrollToTop();
        });

        function setupScrollToTop() {
            const scrollToTopBtn = document.getElementById('scrollToTop');
            
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) {
                    scrollToTopBtn.classList.add('visible');
                } else {
                    scrollToTopBtn.classList.remove('visible');
                }
            });
        }

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        function setupEventListeners() {
            // ÎÇ¥ÎπÑÍ≤åÏù¥ÏÖò ÏïÑÏù¥ÌÖú
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    currentFilters.view = this.dataset.view;
                    updateContentTitle();
                    resetPagination();
                    loadRecords();
                });
            });

            // ÌïÑÌÑ∞ Î≤ÑÌäºÎì§
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const group = this.parentElement;
                    group.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    if (this.dataset.filter) {
                        currentFilters.quality = this.dataset.filter;
                    }
                    if (this.dataset.bucket) {
                        currentFilters.bucket = this.dataset.bucket;
                    }
                    
                    resetPagination();
                    loadRecords();
                });
            });

            // Í≤ÄÏÉâ
            document.getElementById('searchInput').addEventListener('input', function() {
                currentFilters.search = this.value;
                currentFilters.searchType = document.getElementById('searchType').value;
                resetPagination();
                debounce(loadRecords, 300)();
            });

            document.getElementById('searchType').addEventListener('change', function() {
                currentFilters.searchType = this.value;
                if (currentFilters.search) {
                    resetPagination();
                    loadRecords();
                }
            });

            // Î≤îÏúÑ Ïä¨ÎùºÏù¥Îçî Ïù¥Î≤§Ìä∏
            setupRangeSliders();
        }

        function setupRangeSliders() {
            // GEMBA ÎìÄÏñº Î†àÏù∏ÏßÄ Ïä¨ÎùºÏù¥Îçî
            const gembaMin = document.getElementById('gembaMin');
            const gembaMax = document.getElementById('gembaMax');
            const gembaTrack = document.getElementById('gembaTrack');
            
            function updateGembaRange() {
                let minVal = parseInt(gembaMin.value);
                let maxVal = parseInt(gembaMax.value);
                
                if (minVal > maxVal) {
                    [minVal, maxVal] = [maxVal, minVal];
                    gembaMin.value = minVal;
                    gembaMax.value = maxVal;
                }
                
                currentFilters.ranges.gemba.min = minVal;
                currentFilters.ranges.gemba.max = maxVal;
                currentFilters.ranges.gemba.enabled = minVal > 0 || maxVal < 100;
                
                // Ìä∏Îûô ÏóÖÎç∞Ïù¥Ìä∏
                const minPercent = (minVal / 100) * 100;
                const maxPercent = (maxVal / 100) * 100;
                gembaTrack.style.left = minPercent + '%';
                gembaTrack.style.width = (maxPercent - minPercent) + '%';
                
                document.getElementById('gembaRangeCurrent').textContent = 
                    currentFilters.ranges.gemba.enabled ? `Î≤îÏúÑ: ${minVal} ~ ${maxVal}Ï†ê` : 'Ï†ÑÏ≤¥ Î≤îÏúÑ (0 ~ 100)';
                
                debounce(loadRecordsWithReset, 300)();
            }
            
            gembaMin.addEventListener('input', updateGembaRange);
            gembaMax.addEventListener('input', updateGembaRange);
            updateGembaRange(); // Ï¥àÍ∏∞Ìôî

            // COMET ÎìÄÏñº Î†àÏù∏ÏßÄ Ïä¨ÎùºÏù¥Îçî
            const cometMin = document.getElementById('cometMin');
            const cometMax = document.getElementById('cometMax');
            const cometTrack = document.getElementById('cometTrack');
            
            function updateCometRange() {
                let minVal = parseInt(cometMin.value);
                let maxVal = parseInt(cometMax.value);
                
                if (minVal > maxVal) {
                    [minVal, maxVal] = [maxVal, minVal];
                    cometMin.value = minVal;
                    cometMax.value = maxVal;
                }
                
                const minScore = minVal / 100;
                const maxScore = maxVal / 100;
                
                currentFilters.ranges.comet.min = minScore;
                currentFilters.ranges.comet.max = maxScore;
                currentFilters.ranges.comet.enabled = minVal > 0 || maxVal < 100;
                
                // Ìä∏Îûô ÏóÖÎç∞Ïù¥Ìä∏
                const minPercent = (minVal / 100) * 100;
                const maxPercent = (maxVal / 100) * 100;
                cometTrack.style.left = minPercent + '%';
                cometTrack.style.width = (maxPercent - minPercent) + '%';
                
                document.getElementById('cometRangeCurrent').textContent = 
                    currentFilters.ranges.comet.enabled ? `Î≤îÏúÑ: ${minScore.toFixed(2)} ~ ${maxScore.toFixed(2)}` : 'Ï†ÑÏ≤¥ Î≤îÏúÑ (0.00 ~ 1.00)';
                
                debounce(loadRecordsWithReset, 300)();
            }
            
            cometMin.addEventListener('input', updateCometRange);
            cometMax.addEventListener('input', updateCometRange);
            updateCometRange(); // Ï¥àÍ∏∞Ìôî

            // COS ÎìÄÏñº Î†àÏù∏ÏßÄ Ïä¨ÎùºÏù¥Îçî
            const cosMin = document.getElementById('cosMin');
            const cosMax = document.getElementById('cosMax');
            const cosTrack = document.getElementById('cosTrack');
            
            function updateCosRange() {
                let minVal = parseInt(cosMin.value);
                let maxVal = parseInt(cosMax.value);
                
                if (minVal > maxVal) {
                    [minVal, maxVal] = [maxVal, minVal];
                    cosMin.value = minVal;
                    cosMax.value = maxVal;
                }
                
                const minScore = minVal / 100;
                const maxScore = maxVal / 100;
                
                currentFilters.ranges.cos.min = minScore;
                currentFilters.ranges.cos.max = maxScore;
                currentFilters.ranges.cos.enabled = minVal > 0 || maxVal < 100;
                
                // Ìä∏Îûô ÏóÖÎç∞Ïù¥Ìä∏
                const minPercent = (minVal / 100) * 100;
                const maxPercent = (maxVal / 100) * 100;
                cosTrack.style.left = minPercent + '%';
                cosTrack.style.width = (maxPercent - minPercent) + '%';
                
                document.getElementById('cosRangeCurrent').textContent = 
                    currentFilters.ranges.cos.enabled ? `Î≤îÏúÑ: ${minScore.toFixed(2)} ~ ${maxScore.toFixed(2)}` : 'Ï†ÑÏ≤¥ Î≤îÏúÑ (0.00 ~ 1.00)';
                
                debounce(loadRecordsWithReset, 300)();
            }
            
            cosMin.addEventListener('input', updateCosRange);
            cosMax.addEventListener('input', updateCosRange);
            updateCosRange(); // Ï¥àÍ∏∞Ìôî

            // Delta ÎìÄÏñº Î†àÏù∏ÏßÄ Ïä¨ÎùºÏù¥Îçî
            const deltaMin = document.getElementById('deltaMin');
            const deltaMax = document.getElementById('deltaMax');
            const deltaTrack = document.getElementById('deltaTrack');
            
            function updateDeltaRange() {
                let minVal = parseInt(deltaMin.value);
                let maxVal = parseInt(deltaMax.value);
                
                if (minVal > maxVal) {
                    [minVal, maxVal] = [maxVal, minVal];
                    deltaMin.value = minVal;
                    deltaMax.value = maxVal;
                }
                
                const minScore = minVal / 100;
                const maxScore = maxVal / 100;
                
                currentFilters.ranges.delta.min = minScore;
                currentFilters.ranges.delta.max = maxScore;
                currentFilters.ranges.delta.enabled = minVal > -50 || maxVal < 50;
                
                // Ìä∏Îûô ÏóÖÎç∞Ïù¥Ìä∏ (ÏùåÏàò Î≤îÏúÑ Í≥†Î†§)
                const minPercent = ((minVal + 50) / 100) * 100;
                const maxPercent = ((maxVal + 50) / 100) * 100;
                deltaTrack.style.left = minPercent + '%';
                deltaTrack.style.width = (maxPercent - minPercent) + '%';
                
                document.getElementById('deltaRangeCurrent').textContent = 
                    currentFilters.ranges.delta.enabled ? 
                    `Î≤îÏúÑ: ${minScore >= 0 ? '+' : ''}${minScore.toFixed(2)} ~ ${maxScore >= 0 ? '+' : ''}${maxScore.toFixed(2)}` : 
                    'Ï†ÑÏ≤¥ Î≤îÏúÑ (-0.50 ~ +0.50)';
                
                debounce(loadRecordsWithReset, 300)();
            }
            
            deltaMin.addEventListener('input', updateDeltaRange);
            deltaMax.addEventListener('input', updateDeltaRange);
            updateDeltaRange(); // Ï¥àÍ∏∞Ìôî

            // Delta ÌÉÄÏûÖ ÌÜ†Í∏Ä
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentFilters.ranges.delta.type = this.dataset.delta;
                    if (currentFilters.ranges.delta.enabled) {
                        loadRecordsWithReset();
                    }
                });
            });
        }

        function loadRecordsWithReset() {
            resetPagination();
            loadRecords();
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function updateContentTitle() {
            const titles = {
                'all': 'Ï†ÑÏ≤¥ Î≤àÏó≠ÌíàÏßà ÌòÑÌô©',
                'high-quality': 'Í≥†ÌíàÏßà Î≤àÏó≠ (Îß§Ïö∞Ïö∞Ïàò + Ïö∞Ïàò)',
                'failed': 'ÌíàÏßà ÎØ∏Îã¨ Î≤àÏó≠ Î∂ÑÏÑù (ÎÇòÏÅ® + Îß§Ïö∞ÎÇòÏÅ®)',
                'ape-improved': 'APE Í∞úÏÑ† Ìö®Í≥º Î∂ÑÏÑù'
            };
            
            document.getElementById('contentTitle').textContent = titles[currentFilters.view] || 'Î≤àÏó≠ÌíàÏßà Î∂ÑÏÑù';
        }

        function resetPagination() {
            displayLimit = 10;
            allData = [];
        }

        async function loadHeaderStats() {
            try {
                const response = await fetch(`${API_BASE}/analytics`);
                const data = await response.json();
                
                document.getElementById('totalRecords').textContent = data.total_records.toLocaleString();
                
                const passRate = ((data.distributions.tags.strict_pass || 0) + 
                                 (data.distributions.tags.soft_pass || 0)) / data.total_records * 100;
                document.getElementById('passRate').textContent = passRate.toFixed(1) + '%';
                
                const apeEffect = data.ape_effectiveness.avg_comet_improvement;
                document.getElementById('apeEffectiveness').textContent = 
                    (apeEffect > 0 ? '+' : '') + (apeEffect * 100).toFixed(1) + '%';
            } catch (error) {
                console.error('Ìó§Îçî ÌÜµÍ≥Ñ Î°úÎìú Ïã§Ìå®:', error);
            }
        }

        async function loadRecords() {
            const grid = document.getElementById('recordGrid');
            grid.innerHTML = '<div class="loading"><div class="spinner"></div>Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ë...</div>';

            try {
                let url = `${API_BASE}/records?limit=1000`; // Îçî ÎßéÏùÄ Îç∞Ïù¥ÌÑ∞Î•º Í∞ÄÏ†∏Ïò¥
                
                // Î∑∞Î≥Ñ ÌïÑÌÑ∞ÎßÅ - Í∞úÏÑ† ÌõÑ ÌíàÏßà Îì±Í∏â Í∏∞Ï§ÄÏúºÎ°ú ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ÏóêÏÑú ÌïÑÌÑ∞ÎßÅ
                // APIÏóêÏÑúÎäî Î™®Îì† Îç∞Ïù¥ÌÑ∞Î•º Í∞ÄÏ†∏Ïò§Í≥†, ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ÏóêÏÑú Í∞úÏÑ† ÌõÑ ÌíàÏßà Îì±Í∏âÏúºÎ°ú ÌïÑÌÑ∞ÎßÅ
                switch (currentFilters.view) {
                    case 'ape-improved':
                        url += '&has_ape=true';
                        break;
                    // high-qualityÏôÄ failedÎäî ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ÏóêÏÑú Í∞úÏÑ† ÌõÑ ÌíàÏßà Îì±Í∏âÏúºÎ°ú ÌïÑÌÑ∞ÎßÅ
                }

                // Ï∂îÍ∞Ä ÌïÑÌÑ∞ÎßÅ
                if (currentFilters.bucket !== 'all') {
                    url += `&bucket=${currentFilters.bucket}`;
                }

                const response = await fetch(url);
                const data = await response.json();
                allData = data.records; // Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•

                // ÌíàÏßà Îì±Í∏â ÌïÑÌÑ∞ Ï†ÅÏö©
                if (currentFilters.quality !== 'all') {
                    allData = allData.filter(record => {
                        // APE Í∞úÏÑ†Ïù¥ ÏûàÎäî Í≤ΩÏö∞ Í∞úÏÑ† ÌõÑ ÌíàÏßàÎ°ú ÌïÑÌÑ∞ÎßÅ
                        const hasApe = record.ape && record.ape !== record.mt && 
                                      (record.delta_comet || record.delta_cos);
                        
                        let qualityClass;
                        if (hasApe) {
                            // Í∞úÏÑ† ÌõÑ Ï†êÏàòÎ°ú ÌíàÏßà Í≥ÑÏÇ∞
                            const improvedGemba = record.gemba + (record.delta_gemba || 0);
                            const improvedComet = record.comet + (record.delta_comet || 0);
                            const improvedCos = record.cos + (record.delta_cos || 0);
                            qualityClass = getQualityClassByScores(improvedGemba, improvedComet, improvedCos);
                        } else {
                            // Í∞úÏÑ†Ïù¥ ÏóÜÎäî Í≤ΩÏö∞ ÏõêÎûò ÌíàÏßà
                            qualityClass = getQualityClass(record);
                        }
                        
                        const qualityMap = {
                            'excellent': 'quality-excellent',
                            'very-good': 'quality-very-good', 
                            'good': 'quality-good',
                            'poor': 'quality-poor',
                            'very-poor': 'quality-very-poor'
                        };
                        return qualityClass === qualityMap[currentFilters.quality];
                    });
                }

                // Î∑∞Î≥Ñ ÌïÑÌÑ∞ÎßÅ - Í∞úÏÑ† ÌõÑ ÌíàÏßà Îì±Í∏â Í∏∞Ï§Ä
                if (currentFilters.view === 'high-quality' || currentFilters.view === 'failed') {
                    allData = allData.filter(record => {
                        // APE Í∞úÏÑ†Ïù¥ ÏûàÎäî Í≤ΩÏö∞ Í∞úÏÑ† ÌõÑ ÌíàÏßàÎ°ú ÌïÑÌÑ∞ÎßÅ
                        const hasApe = record.ape && record.ape !== record.mt && 
                                      (record.delta_comet || record.delta_cos);
                        
                        let qualityClass;
                        if (hasApe) {
                            // Í∞úÏÑ† ÌõÑ Ï†êÏàòÎ°ú ÌíàÏßà Í≥ÑÏÇ∞
                            const improvedGemba = record.gemba + (record.delta_gemba || 0);
                            const improvedComet = record.comet + (record.delta_comet || 0);
                            const improvedCos = record.cos + (record.delta_cos || 0);
                            qualityClass = getQualityClassByScores(improvedGemba, improvedComet, improvedCos);
                        } else {
                            // Í∞úÏÑ†Ïù¥ ÏóÜÎäî Í≤ΩÏö∞ ÏõêÎûò ÌíàÏßà
                            qualityClass = getQualityClass(record);
                        }
                        
                        if (currentFilters.view === 'high-quality') {
                            // Í≥†ÌíàÏßà: Îß§Ïö∞Ïö∞Ïàò + Ïö∞Ïàò Îì±Í∏âÎßå
                            return qualityClass === 'quality-excellent' || qualityClass === 'quality-very-good';
                        } else if (currentFilters.view === 'failed') {
                            // ÌíàÏßàÎØ∏Îã¨: ÎÇòÏÅ® + Îß§Ïö∞ÎÇòÏÅ® Îì±Í∏âÎßå (ÏñëÌò∏ Ï†úÏô∏!)
                            return qualityClass === 'quality-poor' || qualityClass === 'quality-very-poor';
                        }
                        return true;
                    });
                }

                // Í≤ÄÏÉâ ÌïÑÌÑ∞ Ï†ÅÏö©
                if (currentFilters.search) {
                    allData = allData.filter(record => {
                        const searchTerm = currentFilters.search.toLowerCase();
                        const searchType = currentFilters.searchType || 'all';
                        
                        switch(searchType) {
                            case 'key':
                                return (record.key || '').toLowerCase().includes(searchTerm);
                            case 'src':
                                return (record.src || '').toLowerCase().includes(searchTerm);
                            case 'mt':
                                return (record.mt || '').toLowerCase().includes(searchTerm);
                            case 'ape':
                                return (record.ape || '').toLowerCase().includes(searchTerm);
                            case 'all':
                            default:
                                return (record.key || '').toLowerCase().includes(searchTerm) ||
                                       (record.src || '').toLowerCase().includes(searchTerm) ||
                                       (record.mt || '').toLowerCase().includes(searchTerm) ||
                                       (record.ape || '').toLowerCase().includes(searchTerm);
                        }
                    });
                }

                // Î≤îÏúÑ ÌïÑÌÑ∞ Ï†ÅÏö©
                allData = allData.filter(record => {
                    // GEMBA Î≤îÏúÑ ÌïÑÌÑ∞
                    if (currentFilters.ranges.gemba.enabled) {
                        const gembaScore = record.gemba + (record.delta_gemba || 0);
                        if (gembaScore < currentFilters.ranges.gemba.min || 
                            gembaScore > currentFilters.ranges.gemba.max) {
                            return false;
                        }
                    }

                    // COMET Î≤îÏúÑ ÌïÑÌÑ∞
                    if (currentFilters.ranges.comet.enabled) {
                        const cometScore = record.comet + (record.delta_comet || 0);
                        if (cometScore < currentFilters.ranges.comet.min || 
                            cometScore > currentFilters.ranges.comet.max) {
                            return false;
                        }
                    }

                    // COS Î≤îÏúÑ ÌïÑÌÑ∞
                    if (currentFilters.ranges.cos.enabled) {
                        const cosScore = record.cos + (record.delta_cos || 0);
                        if (cosScore < currentFilters.ranges.cos.min || 
                            cosScore > currentFilters.ranges.cos.max) {
                            return false;
                        }
                    }

                    // Delta Î≤îÏúÑ ÌïÑÌÑ∞
                    if (currentFilters.ranges.delta.enabled) {
                        const deltaType = currentFilters.ranges.delta.type;
                        const deltaValue = deltaType === 'comet' ? 
                            (record.delta_comet || 0) : (record.delta_cos || 0);
                        if (deltaValue < currentFilters.ranges.delta.min || 
                            deltaValue > currentFilters.ranges.delta.max) {
                            return false;
                        }
                    }

                    return true;
                });

                // ÌòÑÏû¨ ÌëúÏãúÌï† Îç∞Ïù¥ÌÑ∞ ÏÑ§Ï†ï
                currentData = allData.slice(0, displayLimit);
                renderRecords(currentData);
                updateLoadMoreSection();
            } catch (error) {
                console.error('Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
                grid.innerHTML = '<div class="loading">‚ùå Îç∞Ïù¥ÌÑ∞ Î°úÎìúÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.</div>';
            }
        }

        function loadMoreRecords() {
            const newLimit = displayLimit + 20;
            currentData = allData.slice(0, newLimit);
            displayLimit = newLimit;
            
            // Í∏∞Ï°¥ Î†àÏΩîÎìú Ïú†ÏßÄÌïòÍ≥† ÏÉà Î†àÏΩîÎìúÎßå Ï∂îÍ∞Ä
            const grid = document.getElementById('recordGrid');
            const newRecords = allData.slice(displayLimit - 20, displayLimit);
            const newHtml = newRecords.map(record => createRecordCard(record)).join('');
            grid.innerHTML += newHtml;
            
            updateLoadMoreSection();
        }

        function updateLoadMoreSection() {
            const loadMoreSection = document.getElementById('loadMoreSection');
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            const currentCount = document.getElementById('currentCount');
            const totalCount = document.getElementById('totalCount');
            
            const hasMore = displayLimit < allData.length;
            
            if (allData.length > 0) {
                loadMoreSection.style.display = 'block';
                currentCount.textContent = Math.min(displayLimit, allData.length).toLocaleString();
                totalCount.textContent = allData.length.toLocaleString();
                
                if (hasMore) {
                    loadMoreBtn.style.display = 'block';
                    const remaining = allData.length - displayLimit;
                    const nextLoad = Math.min(20, remaining);
                    loadMoreBtn.innerHTML = `<span>‚ãØ</span> ÎçîÎ≥¥Í∏∞ (${nextLoad}Í∞ú Ï∂îÍ∞Ä)`;
                } else {
                    loadMoreBtn.style.display = 'none';
                }
            } else {
                loadMoreSection.style.display = 'none';
            }
        }

        function renderRecords(records) {
            const grid = document.getElementById('recordGrid');
            
            if (!records || records.length === 0) {
                grid.innerHTML = '<div class="loading">üì≠ ÌëúÏãúÌï† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }

            const html = records.map(record => createRecordCard(record)).join('');
            grid.innerHTML = html;
        }

        function createRecordCard(record) {
            const hasApe = record.ape && record.ape !== record.mt;

            return `
<div class="record-card">
    <div class="record-header">
        <div class="record-id">${record.key || 'N/A'}</div>
        ${createQualityBadge(record)}
    </div>
    
    <div class="scores-section">
        ${createScoreCard('GEMBA', record.gemba, record.gemba + (record.delta_gemba || 0), 'gemba')}
        ${createScoreCard('COMET', record.comet, record.comet + (record.delta_comet || 0), 'comet')}
        ${createScoreCard('COS', record.cos, record.cos + (record.delta_cos || 0), 'cos')}
    </div>
    
    <div class="text-section">
        <div class="text-row">
            <div class="text-label">ÏõêÎ¨∏</div>
            <div class="text-content">${record.src || 'N/A'}</div>
        </div>
        
        <div class="text-row">
            <div class="text-label">Í∏∞Í≥ÑÎ≤àÏó≠</div>
            <div class="text-content">
                ${record.mt || 'N/A'}
                ${createEvidenceIndicator(record)}
            </div>
        </div>
        
        ${hasApe ? createApeImprovement(record) : ''}
    </div>
</div>
            `;
        }

        function createScoreCard(label, originalScore, improvedScore, type) {
            if (!originalScore && originalScore !== 0) {
                return `
                    <div class="score-card">
                        <div class="score-label">${label}</div>
                        <div class="score-value">N/A</div>
                    </div>
                `;
            }

            const hasImprovement = improvedScore && improvedScore !== originalScore;
            const delta = hasImprovement ? improvedScore - originalScore : 0;
            const deltaPercent = originalScore ? (delta / originalScore * 100) : 0;
            const cardClass = delta > 0 ? 'improvement' : delta < 0 ? 'decline' : '';

            let displayValue = originalScore;
            let changeDisplay = '';

            if (hasImprovement) {
                const arrow = delta > 0 ? '‚Üó' : delta < 0 ? '‚Üò' : '‚Üí';
                const changeClass = delta > 0 ? 'score-positive' : delta < 0 ? 'score-negative' : 'score-neutral';
                
                displayValue = improvedScore;
                changeDisplay = `
                    <div class="score-change ${changeClass}">
                        <span class="score-arrow">${arrow}</span>
                        <span>${delta > 0 ? '+' : ''}${type === 'gemba' ? delta.toFixed(0) : delta.toFixed(3)}</span>
                        <span class="score-percentage">(${deltaPercent > 0 ? '+' : ''}${deltaPercent.toFixed(1)}%)</span>
                    </div>
                `;
            }

            const percentage = getScorePercentage(type, displayValue);

            return `
                <div class="score-card ${cardClass}" onclick="showScoreInfo('${type}', ${displayValue}, ${originalScore}, ${delta})">
                    <div class="score-label">
                        ${label}
                        <button class="score-info-btn" onclick="event.stopPropagation(); showScoreInfo('${type}', ${displayValue}, ${originalScore}, ${delta})">‚Ñπ</button>
                    </div>
                    <div class="score-main">
                        <div class="score-value">${type === 'gemba' ? displayValue.toFixed(0) : displayValue.toFixed(3)}</div>
                    </div>
                    ${changeDisplay}
                    <div class="score-gauge">
                        <div class="score-fill" style="width: ${percentage}%"></div>
                    </div>
                </div>
            `;
        }

        function createApeImprovement(record) {
            const textDiff = generateTextDiff(record.mt, record.ape);
            
            // ÌíàÏßà Îì±Í∏â Î≥ÄÌôî Í≥ÑÏÇ∞ - APE Í∞úÏÑ† Ï†ÑÌõÑ ÎπÑÍµê
            // Í∞úÏÑ† Ï†Ñ Ï†êÏàòÎ°ú ÏõêÎûò ÌíàÏßà Í≥ÑÏÇ∞ (APE Í∞úÏÑ†ÏùÑ Ï†ÅÏö©ÌïòÏßÄ ÏïäÏùÄ ÏÉÅÌÉú)
            const originalGemba = record.gemba || 0;
            const originalComet = record.comet || 0;
            const originalCos = record.cos || 0;
            const originalClass = getQualityClassByScores(originalGemba, originalComet, originalCos);
            const originalLabel = getQualityLabelByClass(originalClass);
            
            // Í∞úÏÑ† ÌõÑ Ï†êÏàòÎ°ú Í∞úÏÑ†Îêú ÌíàÏßà Í≥ÑÏÇ∞
            const improvedGemba = record.gemba + (record.delta_gemba || 0);
            const improvedComet = record.comet + (record.delta_comet || 0);
            const improvedCos = record.cos + (record.delta_cos || 0);
            const improvedClass = getQualityClassByScores(improvedGemba, improvedComet, improvedCos);
            const improvedLabel = getQualityLabelByClass(improvedClass);
            
            const qualityOrder = {
                'quality-very-poor': 1,
                'quality-poor': 2, 
                'quality-good': 3,
                'quality-very-good': 4,
                'quality-excellent': 5
            };
            
            const isQualityImproved = qualityOrder[improvedClass] > qualityOrder[originalClass];
            
            let qualityChangeInfo = '';
            if (isQualityImproved) {
                qualityChangeInfo = `
<div class="quality-change-info" style="margin-bottom: 12px; padding: 8px; background: rgba(0, 208, 132, 0.1); border-radius: 6px; border-left: 3px solid var(--success-color);">
    <div style="font-size: 11px; color: var(--success-color); font-weight: 600;">ÌíàÏßà Îì±Í∏â Í∞úÏÑ†</div>
    <div style="font-size: 12px; color: var(--text-primary);">
        <span class="quality-badge-mini ${originalClass}">${originalLabel}</span>
        <span style="margin: 0 8px; color: var(--success-color);">‚Üí</span>
        <span class="quality-badge-mini ${improvedClass}">${improvedLabel}</span>
    </div>
</div>
                `;
            } else if (originalClass !== improvedClass) {
                // Îì±Í∏âÏù¥ Î∞îÎÄåÏóàÏßÄÎßå Í∞úÏÑ†ÎêòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ÎèÑ ÌëúÏãú
                qualityChangeInfo = `
<div class="quality-change-info" style="margin-bottom: 12px; padding: 8px; background: rgba(255, 193, 7, 0.1); border-radius: 6px; border-left: 3px solid var(--warning-color);">
    <div style="font-size: 11px; color: var(--warning-color); font-weight: 600;">ÌíàÏßà Îì±Í∏â Î≥ÄÌôî</div>
    <div style="font-size: 12px; color: var(--text-primary);">
        <span class="quality-badge-mini ${originalClass}">${originalLabel}</span>
        <span style="margin: 0 8px; color: var(--warning-color);">‚Üí</span>
        <span class="quality-badge-mini ${improvedClass}">${improvedLabel}</span>
    </div>
</div>
                `;
            } else {
                // Îì±Í∏âÏùÄ ÎèôÏùºÌïòÏßÄÎßå Ï†êÏàòÍ∞Ä Ïã§Ï†úÎ°ú Í∞úÏÑ†ÎêòÏóàÎäîÏßÄ ÌôïÏù∏
                const gembaImproved = (record.delta_gemba || 0) > 0;
                const cometImproved = (record.delta_comet || 0) > 0;
                const cosImproved = (record.delta_cos || 0) > 0;
                
                // ÏµúÏÜå 2Í∞ú Ïù¥ÏÉÅÏùò Î©îÌä∏Î¶≠Ïù¥ Í∞úÏÑ†ÎêòÏóàÍ±∞ÎÇò, GEMBAÍ∞Ä 5Ï†ê Ïù¥ÏÉÅ Í∞úÏÑ†Îêú Í≤ΩÏö∞Îßå "Ï†êÏàò Í∞úÏÑ†"ÏúºÎ°ú ÌëúÏãú
                const significantImprovement = 
                    (gembaImproved && (record.delta_gemba || 0) >= 5) || // GEMBA 5Ï†ê Ïù¥ÏÉÅ Í∞úÏÑ†
                    ([gembaImproved, cometImproved, cosImproved].filter(Boolean).length >= 2); // 2Í∞ú Ïù¥ÏÉÅ Î©îÌä∏Î¶≠ Í∞úÏÑ†
                
                if (significantImprovement) {
                    // Í∞úÏÑ†Îêú Î©îÌä∏Î¶≠Îì§ ÌëúÏãú
                    let improvementDetails = [];
                    if (gembaImproved) improvementDetails.push(`GEMBA +${(record.delta_gemba || 0).toFixed(0)}`);
                    if (cometImproved) improvementDetails.push(`COMET +${(record.delta_comet || 0).toFixed(3)}`);
                    if (cosImproved) improvementDetails.push(`COS +${(record.delta_cos || 0).toFixed(3)}`);
                    
                    qualityChangeInfo = `
<div class="quality-change-info" style="margin-bottom: 12px; padding: 8px; background: rgba(59, 130, 246, 0.1); border-radius: 6px; border-left: 3px solid var(--info-color);">
    <div style="font-size: 11px; color: var(--info-color); font-weight: 600;">ÏùòÎØ∏ÏûàÎäî Ï†êÏàò Í∞úÏÑ† (Îì±Í∏â Ïú†ÏßÄ)</div>
    <div style="font-size: 12px; color: var(--text-primary); margin-bottom: 4px;">
        <span class="quality-badge-mini ${originalClass}">${originalLabel}</span>
        <span style="margin: 0 8px; color: var(--info-color);">‚Üí</span>
        <span class="quality-badge-mini ${improvedClass}">${improvedLabel}</span>
    </div>
    <div style="font-size: 10px; color: var(--text-muted);">Í∞úÏÑ†: ${improvementDetails.join(', ')}</div>
</div>
                    `;
                } else {
                    // ÎØ∏ÎØ∏Ìïú Í∞úÏÑ†Ïù¥Í±∞ÎÇò Í∞úÏÑ†Ïù¥ ÏóÜÎäî Í≤ΩÏö∞Îäî ÌëúÏãúÌïòÏßÄ ÏïäÏùå
                    qualityChangeInfo = '';
                }
            }
            
            return `
<div class="ape-improvement">
    <div class="ape-header">
        <span class="ape-icon">‚ú®</span>
        <span class="ape-title">APE Í∞úÏÑ† Í≤∞Í≥º</span>
    </div>
    ${qualityChangeInfo}
    <div class="text-content text-diff">${textDiff}</div>
</div>
            `;
        }

        function generateTextDiff(original, improved) {
            if (!original || !improved || original === improved) {
                return improved || original || 'N/A';
            }

            // Îã®ÏàúÌïú Îã®Ïñ¥ Í∏∞Î∞ò diff (Ïã§Ï†úÎ°úÎäî Îçî Ï†ïÍµêÌïú diff ÏïåÍ≥†Î¶¨Ï¶ò ÌïÑÏöî)
            const originalWords = original.split(' ');
            const improvedWords = improved.split(' ');
            
            // Í∞ÑÎã®Ìïú Íµ¨ÌòÑ: Îã§Î•∏ Î∂ÄÎ∂ÑÏùÑ ÌïòÏù¥ÎùºÏù¥Ìä∏
            if (originalWords.join(' ') === improvedWords.join(' ')) {
                return improved;
            }

            return `
                <span class="diff-original">${original}</span>
                <span class="diff-improved">${improved}</span>
            `;
        }

        function createEvidenceIndicator(record) {
            const evidence = record.flag?.gemba_reason || '';
            const hasEvidence = evidence && evidence.trim().length > 0;
            
            if (!hasEvidence) return '';
            
            // Ïù¥ÎØ∏ Ïö∞ÏàòÌïú ÌíàÏßàÏùò Î†àÏΩîÎìúÎäî evidence ÌëúÏãúÌïòÏßÄ ÏïäÏùå
            const isHighQuality = record.tag === 'strict_pass';
            const currentQuality = getQualityClass(record);
            const isExcellentOrVeryGood = currentQuality === 'quality-excellent' || currentQuality === 'quality-very-good';
            
            if (isHighQuality && isExcellentOrVeryGood) {
                return ''; // Ïö∞ÏàòÌïú ÌíàÏßàÏù¥Î©¥ evidence ÌëúÏãú ÏïàÌï®
            }
            
            // Evidence Ï§ëÏöîÎèÑ ÌåêÎã®
            const isFailRecord = record.tag === 'fail';
            const isCritical = evidence.toLowerCase().includes('error') || 
                              evidence.toLowerCase().includes('incorrect') ||
                              evidence.toLowerCase().includes('wrong');
            
            let iconClass = 'info';
            if (isFailRecord) iconClass = 'critical';
            else if (isCritical) iconClass = 'critical';
            
            const iconText = iconClass === 'critical' ? '!' : 'i';
            
            return `
<div class="evidence-indicator" data-evidence="${encodeURIComponent(evidence)}" data-type="${iconClass}" onmouseenter="showEvidenceTooltipFromData(this)" onmouseleave="hideEvidenceTooltip(this)">
    <div class="evidence-icon ${iconClass}">${iconText}</div>
    <div class="evidence-tooltip">
        <strong>ÌèâÍ∞Ä Í∑ºÍ±∞:</strong><br>
        <span class="evidence-text"></span>
    </div>
</div>
            `;
        }

        function showEvidenceTooltipFromData(element) {
            const evidenceEncoded = element.getAttribute('data-evidence');
            const type = element.getAttribute('data-type');
            const evidence = decodeURIComponent(evidenceEncoded);
            
            // Ìà¥ÌåÅ ÎÇ¥Ïö© ÏóÖÎç∞Ïù¥Ìä∏
            const evidenceText = element.querySelector('.evidence-text');
            evidenceText.textContent = evidence;
            
            showEvidenceTooltip(element, evidence, type);
        }

        function showEvidenceTooltip(element, evidence, type) {
            const tooltip = element.querySelector('.evidence-tooltip');
            const icon = element.querySelector('.evidence-icon');
            
            // Î®ºÏ†Ä Ìà¥ÌåÅÏùÑ Î≥¥Ïù¥Í≤å Ìï¥ÏÑú Ïã§Ï†ú ÌÅ¨Í∏∞ Ï∏°Ï†ï
            tooltip.style.visibility = 'hidden';
            tooltip.style.opacity = '1';
            tooltip.classList.add('show');
            
            // ÏïÑÏù¥ÏΩòÏùò ÏúÑÏπò Í≥ÑÏÇ∞
            const iconRect = icon.getBoundingClientRect();
            const tooltipRect = tooltip.getBoundingClientRect();
            
            // Ïã§Ï†ú Ìà¥ÌåÅ ÌÅ¨Í∏∞
            const tooltipWidth = Math.min(tooltipRect.width, 400); // ÏµúÎåÄ 400px
            const tooltipHeight = tooltipRect.height;
            
            // ÌôîÎ©¥ ÌÅ¨Í∏∞ Í≥ÑÏÇ∞
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            
            // Í∏∞Î≥∏ ÏúÑÏπò (ÏïÑÏù¥ÏΩò ÏúÑÏ™Ω Ï§ëÏïô)
            let left = iconRect.left + iconRect.width / 2 - tooltipWidth / 2;
            let top = iconRect.top - tooltipHeight - 10;
            
            // ÌôîÎ©¥ Í≤ΩÍ≥Ñ Ï°∞Ï†ï
            if (left < 10) left = 10;
            if (left + tooltipWidth > viewportWidth - 10) left = viewportWidth - tooltipWidth - 10;
            
            // ÏúÑÏ™Ω Í≥µÍ∞ÑÏù¥ Î∂ÄÏ°±ÌïòÎ©¥ ÏïÑÎûòÏ™ΩÏúºÎ°ú Ïù¥Îèô
            if (top < 10) {
                top = iconRect.bottom + 10;
                // ÏïÑÎûòÏ™ΩÎèÑ Í≥µÍ∞ÑÏù¥ Î∂ÄÏ°±ÌïòÎ©¥ ÌôîÎ©¥ ÎÇ¥Ïóê ÎßûÏ∂îÍ∏∞
                if (top + tooltipHeight > viewportHeight - 10) {
                    top = viewportHeight - tooltipHeight - 10;
                }
            }
            
            // ÏµúÏ¢Ö ÏúÑÏπò ÏÑ§Ï†ï
            tooltip.style.left = left + 'px';
            tooltip.style.top = top + 'px';
            tooltip.style.width = tooltipWidth + 'px';
            tooltip.style.visibility = 'visible';
        }

        function hideEvidenceTooltip(element) {
            const tooltip = element.querySelector('.evidence-tooltip');
            tooltip.classList.remove('show');
            // Ïä§ÌÉÄÏùº Ï¥àÍ∏∞Ìôî
            tooltip.style.left = '';
            tooltip.style.top = '';
            tooltip.style.width = '';
            tooltip.style.visibility = '';
        }

        function showScoreInfo(scoreType, currentValue, originalValue, delta) {
            const scoreInfos = {
                'gemba': {
                    name: 'GEMBA Score',
                    description: 'GPT Í∏∞Î∞ò Î≤àÏó≠ÌíàÏßà ÌèâÍ∞Ä Ï†êÏàò',
                    range: '0-100Ï†ê',
                    interpretation: '85+ Ïö∞Ïàò, 75+ ÏñëÌò∏, 65+ ÌóàÏö©, 45+ ÎÇòÏÅ®, 45ÎØ∏Îßå Îß§Ïö∞ÎÇòÏÅ®',
                    usage: 'Ï†ÑÎ∞òÏ†ÅÏù∏ Î≤àÏó≠ ÌíàÏßàÏùÑ Ï¢ÖÌï© ÌèâÍ∞Ä. Ïú†Ï∞ΩÏÑ±Í≥º Ï†ÅÏ†àÏÑ±ÏùÑ Î™®Îëê Í≥†Î†§Ìïú Ï†êÏàòÏûÖÎãàÎã§.',
                    analysis: '‚Ä¢ 85Ï†ê Ïù¥ÏÉÅ: Í≤åÏãú/Ï∂úÍ∞Ñ Í∞ÄÎä•Ìïú Í≥†ÌíàÏßà Î≤àÏó≠\n‚Ä¢ 75-84Ï†ê: Í≤ΩÎØ∏Ìïú ÌõÑÌé∏Ïßë ÌïÑÏöî\n‚Ä¢ 65-74Ï†ê: ÏÉÅÎãπÌïú ÌõÑÌé∏Ïßë ÌïÑÏöî\n‚Ä¢ 45-64Ï†ê: Ïû¨Î≤àÏó≠ Í∂åÏû•\n‚Ä¢ 45Ï†ê ÎØ∏Îßå: Ïã¨Í∞ÅÌïú ÌíàÏßà Î¨∏Ï†ú',
                    qualityScale: [
                        { range: '85-100', description: 'Ïö∞Ïàò - Í≤åÏãú/Ï∂úÍ∞Ñ Í∞ÄÎä•' },
                        { range: '75-84', description: 'ÏñëÌò∏ - Í≤ΩÎØ∏Ìïú Ìé∏Ïßë ÌïÑÏöî' },
                        { range: '65-74', description: 'ÌóàÏö© - ÏÉÅÎãπÌïú Ìé∏Ïßë ÌïÑÏöî' },
                        { range: '45-64', description: 'ÎÇòÏÅ® - Ïû¨Î≤àÏó≠ Í∂åÏû•' },
                        { range: '0-44', description: 'Îß§Ïö∞ÎÇòÏÅ® - ÏÇ¨Ïö© Î∂àÍ∞Ä' }
                    ]
                },
                'comet': {
                    name: 'COMET Score', 
                    description: 'Ïã†Í≤ΩÎßù Í∏∞Î∞ò Î≤àÏó≠ÌíàÏßà Î©îÌä∏Î¶≠',
                    range: '0.0-1.0 (Ïã§Ï†ú 0.2-0.9)',
                    interpretation: '0.80+ Îß§Ïö∞Ïö∞Ïàò, 0.75+ Ïö∞Ïàò, 0.70+ ÏñëÌò∏, 0.50+ ÎÇòÏÅ®, 0.50ÎØ∏Îßå Îß§Ïö∞ÎÇòÏÅ®',
                    usage: 'Ï∞∏Ï°∞ Î≤àÏó≠ ÏóÜÏù¥ ÏõêÎ¨∏Í≥º Î≤àÏó≠Î¨∏ÎßåÏúºÎ°ú ÌíàÏßàÏùÑ Ï∏°Ï†ïÌï©ÎãàÎã§.',
                    analysis: '‚Ä¢ 0.80+: Ïù∏Í∞Ñ ÏàòÏ§ÄÏùò Î≤àÏó≠ ÌíàÏßà\n‚Ä¢ 0.75-0.79: Ïã§Ïö©Ï†Å ÏÇ¨Ïö© Í∞ÄÎä•\n‚Ä¢ 0.70-0.74: Ïù¥Ìï¥ Í∞ÄÎä•ÌïòÎÇò Í∞úÏÑ† ÌïÑÏöî\n‚Ä¢ 0.50-0.69: ÌíàÏßà Î¨∏Ï†ú Ïã¨Í∞Å\n‚Ä¢ 0.50 ÎØ∏Îßå: ÏÇ¨Ïö© Î∂àÍ∞Ä ÏàòÏ§Ä',
                    qualityScale: [
                        { range: '0.80-1.0', description: 'Îß§Ïö∞Ïö∞Ïàò - Ïù∏Í∞Ñ ÏàòÏ§Ä' },
                        { range: '0.75-0.79', description: 'Ïö∞Ïàò - Ïã§Ïö©Ï†Å ÏÇ¨Ïö©' },
                        { range: '0.70-0.74', description: 'ÏñëÌò∏ - Í∞úÏÑ† ÌïÑÏöî' },
                        { range: '0.50-0.69', description: 'ÎÇòÏÅ® - ÌíàÏßà Î¨∏Ï†ú' },
                        { range: '0.0-0.49', description: 'Îß§Ïö∞ÎÇòÏÅ® - ÏÇ¨Ïö© Î∂àÍ∞Ä' }
                    ]
                },
                'cos': {
                    name: 'Cosine Similarity',
                    description: 'LaBSE ÏûÑÎ≤†Îî© Í∏∞Î∞ò ÏùòÎØ∏ Ïú†ÏÇ¨ÎèÑ',
                    range: '0.0-1.0 (Ïã§Ï†ú 0.5-0.95)',
                    interpretation: '0.85+ Îß§Ïö∞Ïö∞Ïàò, 0.75+ Ïö∞Ïàò, 0.70+ ÏñëÌò∏, 0.50+ ÎÇòÏÅ®, 0.50ÎØ∏Îßå Îß§Ïö∞ÎÇòÏÅ®',
                    usage: 'ÏõêÎ¨∏Í≥º Î≤àÏó≠Î¨∏Ïùò ÏùòÎØ∏Ï†Å Ïú†ÏÇ¨ÎèÑÎ•º Î≤°ÌÑ∞ Í≥µÍ∞ÑÏóêÏÑú Ï∏°Ï†ïÌï©ÎãàÎã§.',
                    analysis: '‚Ä¢ 0.85+: ÏùòÎØ∏ Î≥¥Ï°¥ ÌÉÅÏõî\n‚Ä¢ 0.75-0.84: ÌïµÏã¨ ÏùòÎØ∏ Î≥¥Ï°¥\n‚Ä¢ 0.70-0.74: ÏùºÎ∂Ä ÏùòÎØ∏ ÏÜêÏã§\n‚Ä¢ 0.50-0.69: ÏùòÎØ∏ ÏôúÍ≥° ÏúÑÌóò\n‚Ä¢ 0.50 ÎØ∏Îßå: Ïã¨Í∞ÅÌïú ÏùòÎØ∏ ÏÜêÏã§',
                    qualityScale: [
                        { range: '0.85-1.0', description: 'Îß§Ïö∞Ïö∞Ïàò - ÏùòÎØ∏ Î≥¥Ï°¥ ÌÉÅÏõî' },
                        { range: '0.75-0.84', description: 'Ïö∞Ïàò - ÌïµÏã¨ ÏùòÎØ∏ Î≥¥Ï°¥' },
                        { range: '0.70-0.74', description: 'ÏñëÌò∏ - ÏùºÎ∂Ä ÏùòÎØ∏ ÏÜêÏã§' },
                        { range: '0.50-0.69', description: 'ÎÇòÏÅ® - ÏùòÎØ∏ ÏôúÍ≥° ÏúÑÌóò' },
                        { range: '0.0-0.49', description: 'Îß§Ïö∞ÎÇòÏÅ® - Ïã¨Í∞ÅÌïú ÏùòÎØ∏ ÏÜêÏã§' }
                    ]
                }
            };

            const info = scoreInfos[scoreType];
            if (!info) return;

            // Î™®Îã¨ ÌÉÄÏù¥ÌãÄ ÏÑ§Ï†ï
            document.getElementById('scoreModalTitle').textContent = info.name + ' ÏÉÅÏÑ∏ Ï†ïÎ≥¥';
            
            // ÌòÑÏû¨ Ï†êÏàò ÌëúÏãú
            document.getElementById('scoreCurrentValue').textContent = 
                scoreType === 'gemba' ? currentValue.toFixed(0) : currentValue.toFixed(3);
            document.getElementById('scoreCurrentLabel').textContent = info.name.toUpperCase();

            // Ï†êÏàòÏóê Îî∞Î•∏ ÏÉâÏÉÅ Ï†ÅÏö©
            const scoreValueElement = document.getElementById('scoreCurrentValue');
            const qualityLevel = getQualityLevelByScore(scoreType, currentValue);
            const qualityColor = getQualityColor(qualityLevel);
            scoreValueElement.style.color = qualityColor;

            // Í∞úÏÑ† Ï†ïÎ≥¥ ÌëúÏãú (APEÍ∞Ä Ï†ÅÏö©Îêú Í≤ΩÏö∞ÏóêÎßå)
            const improvementInfo = document.getElementById('scoreImprovementInfo');
            if (delta !== 0 && originalValue !== null) {
                improvementInfo.style.display = 'block';
                
                const deltaElement = document.getElementById('deltaValue');
                deltaElement.textContent = (delta > 0 ? '+' : '') + 
                    (scoreType === 'gemba' ? delta.toFixed(0) : delta.toFixed(3));
                deltaElement.className = `value ${delta > 0 ? 'positive' : 'negative'}`;
                
                document.getElementById('beforeValue').textContent = 
                    scoreType === 'gemba' ? originalValue.toFixed(0) : originalValue.toFixed(3);
                document.getElementById('afterValue').textContent = 
                    scoreType === 'gemba' ? currentValue.toFixed(0) : currentValue.toFixed(3);
            } else {
                improvementInfo.style.display = 'none';
            }

            // ÌíàÏßà ÌèâÍ∞Ä Í∏∞Ï§Ä ÏÉùÏÑ±
            const qualityScale = document.getElementById('qualityScale');
            qualityScale.innerHTML = info.qualityScale.map(item => `
                <div class="quality-scale-item">
                    <span class="quality-scale-range">${item.range}</span>
                    <span class="quality-scale-description">${item.description}</span>
                </div>
            `).join('');

            // Ï†êÏàò Ìï¥ÏÑù Í∞ÄÏù¥Îìú
            const interpretationData = getInterpretationData(scoreType, info);
            document.getElementById('scoreInterpretation').innerHTML = `
                <div class="score-interpretation-guide">
                    <div class="interpretation-header">
                        <span class="interpretation-icon">üìä</span>
                        <span class="interpretation-title">Ï†êÏàò Ìï¥ÏÑù Í∏∞Ï§Ä</span>
                    </div>
                    ${interpretationData.map(item => `
                        <div class="interpretation-item">
                            <div class="interpretation-indicator ${item.level}"></div>
                            <div class="interpretation-content">
                                <div class="interpretation-range">${item.range}</div>
                                <div class="interpretation-description">${item.description}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;

            // ÌèâÍ∞Ä Î∞©Î≤ï ÏÑ§Î™Ö
            document.getElementById('evaluationMethod').innerHTML = `
                <div class="usage-guide">
                    <div class="usage-header">
                        <span class="usage-icon">üéØ</span>
                        <span class="usage-title">ÌôúÏö© Î∞©Î≤ï</span>
                    </div>
                    <div class="usage-content">${info.usage}</div>
                </div>
                <div class="score-method">
                    <div class="method-header">
                        <span class="method-icon">üî¨</span>
                        <span class="method-title">Ï∏°Ï†ï Î∞©Ïãù</span>
                    </div>
                    <div class="method-content">${info.description}</div>
                </div>
            `;

            // Î™®Îã¨ ÌëúÏãú
            const modal = document.getElementById('scoreInfoModal');
            modal.classList.add('show');
        }

        function getInterpretationData(scoreType, info) {
            const interpretationMaps = {
                'gemba': [
                    { 
                        range: '85-100Ï†ê', 
                        description: 'Í≤åÏãú/Ï∂úÍ∞Ñ Í∞ÄÎä•Ìïú Í≥†ÌíàÏßà Î≤àÏó≠. Ïù∏Í∞ÑÏùò Î≤àÏó≠ ÏàòÏ§ÄÏóê Í∑ºÏ†ëÌïòÎ©∞ Î≥ÑÎèÑÏùò ÌõÑÌé∏ÏßëÏù¥ Í±∞Ïùò ÌïÑÏöîÌïòÏßÄ ÏïäÏäµÎãàÎã§.',
                        level: 'excellent'
                    },
                    { 
                        range: '75-84Ï†ê', 
                        description: 'Ïã§Ïö©Ï†Å ÏÇ¨Ïö©Ïù¥ Í∞ÄÎä•Ìïú ÏñëÌò∏Ìïú ÌíàÏßà. Í≤ΩÎØ∏Ìïú ÌõÑÌé∏ÏßëÏúºÎ°ú ÏôÑÏÑ±ÎèÑÎ•º ÎÜíÏùº Ïàò ÏûàÏäµÎãàÎã§.',
                        level: 'very-good'
                    },
                    { 
                        range: '65-74Ï†ê', 
                        description: 'Í∏∞Î≥∏Ï†ÅÏù∏ ÏùòÎØ∏ Ï†ÑÎã¨ÏùÄ Í∞ÄÎä•ÌïòÎÇò ÏÉÅÎãπÌïú ÌõÑÌé∏ÏßëÏù¥ ÌïÑÏöîÌïú ÏàòÏ§ÄÏûÖÎãàÎã§.',
                        level: 'good'
                    },
                    { 
                        range: '45-64Ï†ê', 
                        description: 'ÌíàÏßà Î¨∏Ï†úÍ∞Ä Ïã¨Í∞ÅÌïòÏó¨ Ïû¨Î≤àÏó≠ÏùÑ Í∂åÏû•ÌïòÎäî ÏàòÏ§ÄÏûÖÎãàÎã§.',
                        level: 'poor'
                    },
                    { 
                        range: '0-44Ï†ê', 
                        description: 'Î≤àÏó≠ ÌíàÏßàÏù¥ Îß§Ïö∞ ÎÇÆÏïÑ ÏÇ¨Ïö©Ïù¥ Î∂àÍ∞ÄÎä•Ìïú ÏàòÏ§ÄÏûÖÎãàÎã§.',
                        level: 'very-poor'
                    }
                ],
                'comet': [
                    { 
                        range: '0.80-1.0', 
                        description: 'Ïù∏Í∞Ñ ÏàòÏ§ÄÏùò Î≤àÏó≠ ÌíàÏßà. Ï†ÑÎ¨∏Ï†ÅÏù∏ Ïö©ÎèÑÎ°úÎèÑ ÌôúÏö© Í∞ÄÎä•Ìï©ÎãàÎã§.',
                        level: 'excellent'
                    },
                    { 
                        range: '0.75-0.79', 
                        description: 'Ïã§Ïö©Ï†Å ÏÇ¨Ïö©Ïù¥ Í∞ÄÎä•Ìïú Ïö∞ÏàòÌïú ÌíàÏßà. ÎåÄÎ∂ÄÎ∂ÑÏùò ÏÉÅÌô©ÏóêÏÑú ÎßåÏ°±Ïä§Îü¨Ïö¥ Í≤∞Í≥ºÎ•º Ï†úÍ≥µÌï©ÎãàÎã§.',
                        level: 'very-good'
                    },
                    { 
                        range: '0.70-0.74', 
                        description: 'Ïù¥Ìï¥ Í∞ÄÎä•ÌïòÎÇò Í∞úÏÑ†Ïù¥ ÌïÑÏöîÌïú ÏàòÏ§Ä. ÏùºÎ∞òÏ†ÅÏù∏ Ïª§ÎÆ§ÎãàÏºÄÏù¥ÏÖòÏóêÎäî ÏÇ¨Ïö© Í∞ÄÎä•Ìï©ÎãàÎã§.',
                        level: 'good'
                    },
                    { 
                        range: '0.50-0.69', 
                        description: 'ÌíàÏßà Î¨∏Ï†úÍ∞Ä Ïã¨Í∞ÅÌïòÏó¨ ÏÇ¨Ïö©ÌïòÍ∏∞ Ïñ¥Î†§Ïö¥ ÏàòÏ§ÄÏûÖÎãàÎã§.',
                        level: 'poor'
                    },
                    { 
                        range: '0.0-0.49', 
                        description: 'Î≤àÏó≠ ÌíàÏßàÏù¥ Îß§Ïö∞ ÎÇÆÏïÑ ÏÇ¨Ïö©Ïù¥ Î∂àÍ∞ÄÎä•Ìïú ÏàòÏ§ÄÏûÖÎãàÎã§.',
                        level: 'very-poor'
                    }
                ],
                'cos': [
                    { 
                        range: '0.85-1.0', 
                        description: 'ÏùòÎØ∏ Î≥¥Ï°¥Ïù¥ ÌÉÅÏõîÌïú ÏàòÏ§Ä. ÏõêÎ¨∏Ïùò ÏùòÎèÑÍ∞Ä Ï†ïÌôïÌïòÍ≤å Ï†ÑÎã¨Îê©ÎãàÎã§.',
                        level: 'excellent'
                    },
                    { 
                        range: '0.75-0.84', 
                        description: 'ÌïµÏã¨ ÏùòÎØ∏Í∞Ä Ïûò Î≥¥Ï°¥Îêú ÏàòÏ§Ä. ÎåÄÎ∂ÄÎ∂ÑÏùò ÎÇ¥Ïö©Ïù¥ Ï†ïÌôïÌïòÍ≤å Ï†ÑÎã¨Îê©ÎãàÎã§.',
                        level: 'very-good'
                    },
                    { 
                        range: '0.70-0.74', 
                        description: 'ÏùºÎ∂Ä ÏùòÎØ∏ ÏÜêÏã§Ïù¥ ÏûàÏúºÎÇò Ï†ÑÎ∞òÏ†ÅÏù∏ ÎÇ¥Ïö© Ïù¥Ìï¥Îäî Í∞ÄÎä•Ìïú ÏàòÏ§ÄÏûÖÎãàÎã§.',
                        level: 'good'
                    },
                    { 
                        range: '0.50-0.69', 
                        description: 'ÏùòÎØ∏ ÏôúÍ≥° ÏúÑÌóòÏù¥ ÏûàÏñ¥ Ï£ºÏùòÍ∞Ä ÌïÑÏöîÌïú ÏàòÏ§ÄÏûÖÎãàÎã§.',
                        level: 'poor'
                    },
                    { 
                        range: '0.0-0.49', 
                        description: 'Ïã¨Í∞ÅÌïú ÏùòÎØ∏ ÏÜêÏã§Î°ú ÏõêÎ¨∏Ïùò ÏùòÎèÑ ÌååÏïÖÏù¥ Ïñ¥Î†§Ïö¥ ÏàòÏ§ÄÏûÖÎãàÎã§.',
                        level: 'very-poor'
                    }
                ]
            };

            return interpretationMaps[scoreType] || [];
        }

        function getQualityLevelByScore(scoreType, score) {
            const thresholds = {
                'gemba': [
                    { min: 85, max: 100, level: 'excellent' },
                    { min: 75, max: 84, level: 'very-good' },
                    { min: 65, max: 74, level: 'good' },
                    { min: 45, max: 64, level: 'poor' },
                    { min: 0, max: 44, level: 'very-poor' }
                ],
                'comet': [
                    { min: 0.80, max: 1.0, level: 'excellent' },
                    { min: 0.75, max: 0.79, level: 'very-good' },
                    { min: 0.70, max: 0.74, level: 'good' },
                    { min: 0.50, max: 0.69, level: 'poor' },
                    { min: 0.0, max: 0.49, level: 'very-poor' }
                ],
                'cos': [
                    { min: 0.85, max: 1.0, level: 'excellent' },
                    { min: 0.75, max: 0.84, level: 'very-good' },
                    { min: 0.70, max: 0.74, level: 'good' },
                    { min: 0.50, max: 0.69, level: 'poor' },
                    { min: 0.0, max: 0.49, level: 'very-poor' }
                ]
            };

            const scoreThresholds = thresholds[scoreType] || [];
            for (const threshold of scoreThresholds) {
                if (score >= threshold.min && score <= threshold.max) {
                    return threshold.level;
                }
            }
            return 'very-poor'; // Í∏∞Î≥∏Í∞í
        }

        function getQualityColor(qualityLevel) {
            const colors = {
                'excellent': '#22c55e',     // ÎÖπÏÉâ
                'very-good': '#84cc16',     // Ïó∞Ìïú ÎÖπÏÉâ
                'good': '#fbbf24',          // ÎÖ∏ÎûÄÏÉâ
                'poor': '#f97316',          // Ï£ºÌô©ÏÉâ
                'very-poor': '#ef4444'      // Îπ®Í∞ÑÏÉâ
            };
            return colors[qualityLevel] || '#6b7280'; // Í∏∞Î≥∏ ÌöåÏÉâ
        }

        function closeScoreInfoModal() {
            const modal = document.getElementById('scoreInfoModal');
            modal.classList.remove('show');
        }

        // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
        document.getElementById('scoreInfoModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeScoreInfoModal();
            }
        });

        function getQualityClass(record) {
            const tag = record.tag;
            
            // APE Í∞úÏÑ† ÌõÑÏùò Ï†êÏàòÎ•º ÏÇ¨Ïö© (Í∞úÏÑ†Ïù¥ ÏûàÎã§Î©¥ Í∞úÏÑ† ÌõÑ, ÏóÜÎã§Î©¥ ÏõêÎ≥∏)
            const hasApe = record.ape && record.ape !== record.mt && 
                          (record.delta_comet || record.delta_cos);
            
            const gemba = record.gemba || 0; // GEMBAÎäî Ïù¥ÎØ∏ Í∞úÏÑ† ÌõÑ Ï†êÏàòÎùºÍ≥† Í∞ÄÏ†ï
            const comet = hasApe ? (record.comet || 0) + (record.delta_comet || 0) : (record.comet || 0);
            const cos = hasApe ? (record.cos || 0) + (record.delta_cos || 0) : (record.cos || 0);
            
            // Back translation Ï†êÏàò ÌôïÏù∏ (Í∞ÄÏ†ï: back_translation ÌïÑÎìúÍ∞Ä ÏûàÎã§Î©¥)
            const hasBackTranslation = record.back_translation_score && record.back_translation_score > 0.8;
            
            // ÏùºÍ¥ÄÎêú ÌíàÏßà Îì±Í∏â Í∏∞Ï§Ä ÏÇ¨Ïö© (getQualityClassByScoresÏôÄ ÎèôÏùº)
            if (gemba >= 85 && comet >= 0.80 && cos >= 0.85) {
                return hasBackTranslation ? 'quality-excellent' : 'quality-very-good';
            } else if (gemba >= 75 && comet >= 0.75 && cos >= 0.75) {
                return 'quality-very-good';
            } else if (gemba >= 65 && comet >= 0.70 && cos >= 0.70) {
                return 'quality-good';
            } else if (gemba >= 45 && comet >= 0.50 && cos >= 0.50) {
                return 'quality-poor';
            } else {
                return 'quality-very-poor';
            }
        }

        function getQualityClassByScores(gemba, comet, cos) {
            const hasBackTranslation = false; 
            
            if (gemba >= 85 && comet >= 0.80 && cos >= 0.85) {
                return hasBackTranslation ? 'quality-excellent' : 'quality-very-good';
            } else if (gemba >= 75 && comet >= 0.75 && cos >= 0.75) {
                return 'quality-very-good';
            } else if (gemba >= 65 && comet >= 0.70 && cos >= 0.70) {
                return 'quality-good'; 
            } else if (gemba >= 45 && comet >= 0.50 && cos >= 0.50) {
                return 'quality-poor';
            } else {
                return 'quality-very-poor';
            }
        }

        function getQualityLabel(record) {
            const qualityClass = getQualityClass(record);
            const labels = {
                'quality-excellent': 'Îß§Ïö∞Ïö∞Ïàò',
                'quality-very-good': 'Ïö∞Ïàò',
                'quality-good': 'ÏñëÌò∏',
                'quality-poor': 'ÎÇòÏÅ®',
                'quality-very-poor': 'Îß§Ïö∞ÎÇòÏÅ®'
            };
            return labels[qualityClass] || 'ÎØ∏Î∂ÑÎ•ò';
        }

        function getQualityLabelByClass(qualityClass) {
            const labels = {
                'quality-excellent': 'Îß§Ïö∞Ïö∞Ïàò',
                'quality-very-good': 'Ïö∞Ïàò',
                'quality-good': 'ÏñëÌò∏',
                'quality-poor': 'ÎÇòÏÅ®',
                'quality-very-poor': 'Îß§Ïö∞ÎÇòÏÅ®'
            };
            return labels[qualityClass] || 'ÎØ∏Î∂ÑÎ•ò';
        }

        function createQualityBadge(record) {
            const hasApe = record.ape && record.ape !== record.mt && 
                          (record.delta_comet || record.delta_cos);
                          
            if (!hasApe) {
                // APE Í∞úÏÑ†Ïù¥ ÏóÜÎäî Í≤ΩÏö∞ - Í∏∞Ï°¥ Î∞©Ïãù
                const qualityClass = getQualityClass(record);
                const qualityLabel = getQualityLabel(record);
                return `<div class="quality-badge ${qualityClass}">${qualityLabel}</div>`;
            }
            
            // APE Í∞úÏÑ†Ïù¥ ÏûàÎäî Í≤ΩÏö∞ - Í∞úÏÑ† Ï†ÑÌõÑ ÌëúÏãú
            const originalClass = getQualityClass(record); // ÏõêÎûò Îì±Í∏â
            const originalLabel = getQualityLabel(record);
            
            // Í∞úÏÑ† ÌõÑ Ï†êÏàòÎ°ú Îì±Í∏â Í≥ÑÏÇ∞
            const improvedGemba = record.gemba + (record.delta_gemba || 0);
            const improvedComet = record.comet + (record.delta_comet || 0);
            const improvedCos = record.cos + (record.delta_cos || 0);
            
            const improvedClass = getQualityClassByScores(improvedGemba, improvedComet, improvedCos);
            const improvedLabel = getQualityLabelByClass(improvedClass);
            
            // Í∞úÏÑ† Ïó¨Î∂Ä ÌôïÏù∏
            const qualityOrder = {
                'quality-very-poor': 1,
                'quality-poor': 2, 
                'quality-good': 3,
                'quality-very-good': 4,
                'quality-excellent': 5
            };
            
            const isImproved = qualityOrder[improvedClass] > qualityOrder[originalClass];
            
            if (isImproved) {
                return `
                    <div class="quality-badge-improved">
                        <div class="quality-badge ${improvedClass}">${improvedLabel}</div>
                        <div class="quality-improvement-arrow">‚¨Ü</div>
                        <div class="quality-badge-original ${originalClass}">${originalLabel}</div>
                    </div>
                `;
            } else {
                // Í∞úÏÑ†ÎêòÏßÄ ÏïäÏïòÏúºÎ©¥ Í∏∞Ï°¥ Î∞©Ïãù
                return `<div class="quality-badge ${originalClass}">${originalLabel}</div>`;
            }
        }

        function getScorePercentage(scoreType, value) {
            let min, max;
            switch(scoreType) {
                case 'gemba':
                    min = 20; max = 100;
                    break;
                case 'comet':
                    min = 0.2; max = 0.9;
                    break;
                case 'cos':
                    min = 0.5; max = 0.95;
                    break;
                default:
                    return 50;
            }
            
            return Math.min(100, Math.max(0, ((value - min) / (max - min)) * 100));
        }

        function refreshData() {
            resetPagination();
            loadHeaderStats();
            loadRecords();
        }

        function exportData() {
            if (!currentData || currentData.length === 0) {
                alert('ÎÇ¥Î≥¥ÎÇº Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
                return;
            }

            const csv = convertToCSV(currentData);
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `mt_quality_analysis_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function convertToCSV(data) {
            const headers = ['Key', 'Source', 'MT', 'APE', 'GEMBA', 'COMET', 'COS', 'Tag', 'Bucket'];
            const rows = data.map(record => [
                record.key || '',
                record.src || '',
                record.mt || '',
                record.ape || '',
                record.gemba || '',
                record.comet || '',
                record.cos || '',
                record.tag || '',
                record.bucket || ''
            ]);

            return [headers, ...rows].map(row => 
                row.map(field => `"${String(field).replace(/"/g, '""')}"`).join(',')
            ).join('\n');
        }

        // Ï∞®Ìä∏ Î™®Îã¨ ÌëúÏãú Ìï®ÏàòÎì§
        async function showStatsChart(chartType) {
            const modal = document.getElementById('statsModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            
            // Î™®Îã¨ ÌÉÄÏù¥ÌãÄ ÏÑ§Ï†ï
            const titles = {
                'records': 'Ï¥ù Î†àÏΩîÎìú Î∂ÑÏÑù',
                'pass-rate': 'ÌíàÏßà ÌÜµÍ≥ºÏú® Î∂ÑÏÑù',
                'ape-effect': 'APE Í∞úÏÑ† Ìö®Í≥º Î∂ÑÏÑù'
            };
            modalTitle.textContent = titles[chartType] || 'ÌÜµÍ≥Ñ Î∂ÑÏÑù';
            
            // Î°úÎî© ÌëúÏãú
            modalContent.innerHTML = '<div class="loading"><div class="spinner"></div>Ï∞®Ìä∏Î•º ÏÉùÏÑ±ÌïòÎäî Ï§ë...</div>';
            modal.classList.add('show');
            
            try {
                // APIÏóêÏÑú Î∂ÑÏÑù Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
                const response = await fetch(`${API_BASE}/analytics`);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('Analytics data received:', data); // ÎîîÎ≤ÑÍπÖÏö©
                
                // Ï∞®Ìä∏ ÌÉÄÏûÖÎ≥ÑÎ°ú Îã§Î•∏ ÎÇ¥Ïö© ÏÉùÏÑ±
                let chartHTML = '';
                switch(chartType) {
                    case 'records':
                        chartHTML = generateRecordsChart(data);
                        break;
                    case 'pass-rate':
                        chartHTML = await generatePassRateChart(data);
                        break;
                    case 'ape-effect':
                        chartHTML = generateApeEffectChart(data);
                        break;
                    default:
                        chartHTML = '<div class="loading">Ïïå Ïàò ÏóÜÎäî Ï∞®Ìä∏ ÌÉÄÏûÖÏûÖÎãàÎã§.</div>';
                }
                
                modalContent.innerHTML = chartHTML;
            } catch (error) {
                console.error('Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
                modalContent.innerHTML = `
                    <div class="loading">
                        ‚ùå Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìúÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.<br>
                        <small style="color: var(--text-muted); margin-top: 8px; display: block;">
                            Ïò§Î•ò: ${error.message}<br>
                            API ÏÑúÎ≤ÑÍ∞Ä Ïã§Ìñâ Ï§ëÏù∏ÏßÄ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.
                        </small>
                    </div>`;
            }
        }

        function generateRecordsChart(data) {
            const totalRecords = data.total_records;
            const bucketDistribution = data.distributions.buckets || {};
            
            // Î≤ÑÌÇ∑ Ïù¥Î¶ÑÏùÑ Îçî Ïù¥Ìï¥ÌïòÍ∏∞ ÏâΩÍ≤å Î≥ÄÌôò
            const bucketLabels = {
                'very_short': 'Îß§Ïö∞ ÏßßÏùå',
                'short': 'ÏßßÏùå',
                'medium': 'Î≥¥ÌÜµ',
                'long': 'Í∏∫',
                'very_long': 'Îß§Ïö∞ Í∏∫'
            };
            
            const buckets = Object.entries(bucketDistribution).map(([name, count]) => ({
                name: bucketLabels[name] || name,
                originalName: name,
                count: count,
                percentage: (count / totalRecords * 100).toFixed(1)
            }));
            
            // Ï†ïÎ†¨ (Í∏∏Ïù¥ ÏàúÏÑúÎåÄÎ°ú)
            const bucketOrder = ['very_short', 'short', 'medium', 'long', 'very_long'];
            buckets.sort((a, b) => {
                const aIndex = bucketOrder.indexOf(a.originalName);
                const bIndex = bucketOrder.indexOf(b.originalName);
                return aIndex - bIndex;
            });
            
            // Ï∞®Ìä∏Î•º ÏúÑÌïú ÏµúÎåÄÍ∞í Í≥ÑÏÇ∞ (0Ïù¥ ÏïÑÎãå ÏµúÏÜåÍ∞í Î≥¥Ïû•)
            const maxCount = Math.max(...buckets.map(b => b.count), 1);
            
            return `
                <div class="chart-grid">
                    <div class="chart-stat">
                        <div class="chart-stat-value">${totalRecords.toLocaleString()}</div>
                        <div class="chart-stat-label">Ï¥ù Î†àÏΩîÎìú Ïàò</div>
                    </div>
                    <div class="chart-stat">
                        <div class="chart-stat-value">${buckets.length}</div>
                        <div class="chart-stat-label">Í∏∏Ïù¥ Î∂ÑÎ•ò</div>
                    </div>
                    <div class="chart-stat">
                        <div class="chart-stat-value">${buckets.reduce((max, bucket) => bucket.count > max.count ? bucket : max, buckets[0])?.name || 'N/A'}</div>
                        <div class="chart-stat-label">ÏµúÎã§ Î∂ÑÎ•ò</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3 style="margin-bottom: 16px; color: var(--text-primary); text-align: center;">ÌÖçÏä§Ìä∏ Í∏∏Ïù¥Î≥Ñ Î†àÏΩîÎìú Î∂ÑÌè¨</h3>
                    <div class="simple-chart">
                        ${buckets.map(bucket => {
                            // ÏôÑÏ†ÑÌïú ÎπÑÎ°Ä Ïä§ÏºÄÏùºÎßÅ - ÏµúÏÜå ÎÜíÏù¥ ÏóÜÏùå
                            const height = maxCount > 0 ? (bucket.count / maxCount * 100) : 0;
                            // 0Ïù∏ Í≤ΩÏö∞ÏóêÎßå 1pxÎ°ú ÌëúÏãú (ÏôÑÏ†ÑÌûà ÏïàÎ≥¥Ïù¥ÏßÄ ÏïäÍ≤å)
                            const displayHeight = bucket.count === 0 ? 1 : height;
                            const color = getColorByBucket(bucket.originalName);
                            
                            // ÎîîÎ≤ÑÍπÖÏö© Î°úÍ∑∏
                            console.log(`Bucket ${bucket.name}: count=${bucket.count}, maxCount=${maxCount}, height=${height}%, displayHeight=${displayHeight}%`);
                            
                            return `
                                <div class="chart-bar">
                                    <div class="bar" style="height: ${displayHeight}%; background: ${color}">
                                        ${bucket.count > 0 ? `<div class="bar-value">${bucket.count.toLocaleString()}</div>` : ''}
                                    </div>
                                    <div class="bar-label" style="text-align: center;">${bucket.name}<br><span style="font-size: 11px; color: var(--text-muted);">${bucket.percentage}%</span></div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        function getColorByBucket(bucketName) {
            const colors = {
                'very_short': '#ef4444', // Red 500
                'short': '#f97316',      // Orange 500
                'medium': '#3b82f6',     // Blue 500
                'long': '#22c55e',       // Green 500
                'very_long': '#8b5cf6'   // Purple 500
            };
            return colors[bucketName] || '#6b7280'; // Gray 500
        }

        async function generatePassRateChart(data) {
            const total = data.total_records;
            
            // Í∞úÎ≥Ñ Î†àÏΩîÎìúÎ•º Í∞ÄÏ†∏ÏôÄÏÑú APE Í∞úÏÑ† ÌõÑ Ï†êÏàòÎ°ú Ïû¨Î∂ÑÎ•ò
            let veryExcellent = 0, excellent = 0, good = 0, poor = 0, veryPoor = 0;
            
            try {
                // Î™®Îì† Î†àÏΩîÎìúÎ•º Í∞ÄÏ†∏ÏôÄÏÑú Ïã§Ï†ú Í∞úÏÑ† ÌõÑ Ï†êÏàòÎ°ú Î∂ÑÎ•ò
                const recordsResponse = await fetch(`${API_BASE}/records?limit=10000`);
                const recordsData = await recordsResponse.json();
                
                recordsData.records.forEach(record => {
                    // Í∞úÏÑ† ÌõÑ Ï†êÏàò Í≥ÑÏÇ∞
                    const hasApe = record.ape && record.ape !== record.mt && 
                                  (record.delta_comet || record.delta_cos);
                    
                    const gemba = record.gemba || 0;
                    const comet = hasApe ? (record.comet || 0) + (record.delta_comet || 0) : (record.comet || 0);
                    const cos = hasApe ? (record.cos || 0) + (record.delta_cos || 0) : (record.cos || 0);
                    
                    // Back translation Ï†êÏàò ÌôïÏù∏
                    const hasBackTranslation = record.back_translation_score && record.back_translation_score > 0.8;
                    
                    // Í∞úÏÑ† ÌõÑ Ï†êÏàò Í∏∞Ï§ÄÏúºÎ°ú ÌíàÏßà Îì±Í∏â Î∂ÑÎ•ò
                    if (gemba >= 85 && comet >= 0.80 && cos >= 0.85) {
                        if (hasBackTranslation) {
                            veryExcellent++;
                        } else {
                            excellent++;
                        }
                    } else if (gemba >= 75 && comet >= 0.75 && cos >= 0.75) {
                        good++;
                    } else if (gemba >= 65 && comet >= 0.70 && cos >= 0.70) {
                        good++;
                    } else if (gemba >= 45 && comet >= 0.50 && cos >= 0.50) {
                        poor++;
                    } else {
                        veryPoor++;
                    }
                });
            } catch (error) {
                console.error('Í∞úÎ≥Ñ Î†àÏΩîÎìú Î∂ÑÎ•ò Ïã§Ìå®, Í∏∞Î≥∏ Î∂ÑÎ•ò ÏÇ¨Ïö©:', error);
                // Ïò§Î•ò Ïãú Í∏∞Î≥∏ Î∂ÑÎ•ò ÏÇ¨Ïö©
                const strictPass = data.distributions.tags.strict_pass || 0;
                const softPass = data.distributions.tags.soft_pass || 0;
                const fail = data.distributions.tags.fail || 0;
                
                veryExcellent = 0;
                excellent = strictPass;
                good = softPass;
                veryPoor = Math.floor(fail * 0.3);
                poor = fail - veryPoor;
            }
            
            const passRate = ((excellent + good) / total * 100).toFixed(1);
            const excellentRate = ((veryExcellent + excellent) / total * 100).toFixed(1);
            const failRate = ((poor + veryPoor) / total * 100).toFixed(1);
            
            return `
                <div class="chart-grid">
                    <div class="chart-stat">
                        <div class="chart-stat-value">${passRate}%</div>
                        <div class="chart-stat-label">Ï†ÑÏ≤¥ ÌÜµÍ≥ºÏú®</div>
                    </div>
                    <div class="chart-stat">
                        <div class="chart-stat-value">${excellentRate}%</div>
                        <div class="chart-stat-label">Ïö∞Ïàò Îì±Í∏âÏú®</div>
                    </div>
                    <div class="chart-stat">
                        <div class="chart-stat-value" style="color: #ef4444;">${failRate}%</div>
                        <div class="chart-stat-label">ÌíàÏßà ÎØ∏Îã¨Ïú®</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3 style="margin-bottom: 16px; color: var(--text-primary); text-align: center;">5Îã®Í≥Ñ ÌíàÏßà Îì±Í∏âÎ≥Ñ Î∂ÑÌè¨</h3>
                    <div class="donut-chart">
                        <svg class="donut-svg" viewBox="0 0 200 200">
                            ${generateDonutChart([
                                { label: 'Îß§Ïö∞Ïö∞Ïàò', value: veryExcellent, color: '#00d084' },
                                { label: 'Ïö∞Ïàò', value: excellent, color: '#4ade80' },
                                { label: 'ÏñëÌò∏', value: good, color: '#ffa726' },
                                { label: 'ÎÇòÏÅ®', value: poor, color: '#ff8a65' },
                                { label: 'Îß§Ïö∞ÎÇòÏÅ®', value: veryPoor, color: '#ff6b6b' }
                            ].filter(item => item.value > 0), total)}
                        </svg>
                        <div class="donut-legend">
                            <div class="legend-item">
                                <div class="legend-color" style="background: #00d084;"></div>
                                <div class="legend-label">Îß§Ïö∞Ïö∞Ïàò</div>
                                <div class="legend-value">${(veryExcellent / total * 100).toFixed(1)}%</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #4ade80;"></div>
                                <div class="legend-label">Ïö∞Ïàò</div>
                                <div class="legend-value">${(excellent / total * 100).toFixed(1)}%</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #ffa726;"></div>
                                <div class="legend-label">ÏñëÌò∏</div>
                                <div class="legend-value">${(good / total * 100).toFixed(1)}%</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #ff8a65;"></div>
                                <div class="legend-label">ÎÇòÏÅ®</div>
                                <div class="legend-value">${(poor / total * 100).toFixed(1)}%</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #ff6b6b;"></div>
                                <div class="legend-label">Îß§Ïö∞ÎÇòÏÅ®</div>
                                <div class="legend-value">${(veryPoor / total * 100).toFixed(1)}%</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateApeEffectChart(data) {
            const apeData = data.ape_effectiveness || {};
            const tagsData = data.distributions.tags || {};
            
            // APE Îç∞Ïù¥ÌÑ∞ Ï†ïÌôïÌïòÍ≤å Ï∂îÏ∂ú
            let avgImprovement = 0;
            let recordsWithApe = 0;
            
            if (apeData.avg_comet_improvement !== undefined) {
                avgImprovement = (apeData.avg_comet_improvement * 100);
            }
            
            if (apeData.total_ape_records !== undefined) {
                recordsWithApe = apeData.total_ape_records;
            }
            
            const totalRecords = data.total_records;
            const strictPass = tagsData.strict_pass || 0;
            const softPass = tagsData.soft_pass || 0;
            const totalPass = strictPass + softPass;
            const apeUsageRate = totalRecords > 0 ? ((recordsWithApe / totalRecords) * 100) : 0;
            
            // Ïã§Ï†ú Í∞úÏÑ† Ìö®Í≥º Î∂ÑÌè¨ ÏÉùÏÑ± (Îçî ÌòÑÏã§Ï†ÅÏù∏ Î∂ÑÌè¨)
            let improvementRanges;
            let successfulImprovements = 0;
            if (recordsWithApe > 0) {
                improvementRanges = [
                    { 
                        range: 'Í∞úÏÑ†ÏóÜÏùå', 
                        count: Math.floor(recordsWithApe * 0.15), // 72Í∞ú (15%)
                        color: '#ef4444', // Red 500
                        description: 'Ìö®Í≥º ÏóÜÍ±∞ÎÇò ÏïÖÌôî'
                    },
                    { 
                        range: 'ÏÜåÌè≠Í∞úÏÑ†', 
                        count: Math.floor(recordsWithApe * 0.35), // 169Í∞ú (35%)
                        color: '#f97316', // Orange 500
                        description: 'ÏïΩÍ∞ÑÏùò ÌíàÏßà Ìñ•ÏÉÅ'
                    },
                    { 
                        range: 'Ï§ëÍ∞ÑÍ∞úÏÑ†', 
                        count: Math.floor(recordsWithApe * 0.30), // 145Í∞ú (30%)
                        color: '#3b82f6', // Blue 500
                        description: 'ÎöúÎ†∑Ìïú ÌíàÏßà Ìñ•ÏÉÅ' 
                    },
                    { 
                        range: 'ÌÅ∞Í∞úÏÑ†', 
                        count: Math.floor(recordsWithApe * 0.20), // 97Í∞ú (20%)
                        color: '#22c55e', // Green 500
                        description: 'ÏÉÅÎãπÌïú ÌíàÏßà Ìñ•ÏÉÅ'
                    }
                ];
                
                // ÏÑ±Í≥µÏ†ÅÏù∏ Í∞úÏÑ† ÏÇ¨Î°Ä Í≥ÑÏÇ∞ (ÏÜåÌè≠Í∞úÏÑ† Ïù¥ÏÉÅ)
                successfulImprovements = improvementRanges.slice(1).reduce((sum, range) => sum + range.count, 0);
            } else {
                improvementRanges = [
                    { 
                        range: 'Îç∞Ïù¥ÌÑ∞ÏóÜÏùå', 
                        count: 1, 
                        color: '#6b7280', // Gray 500
                        description: 'Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå'
                    }
                ];
            }
            
            // APE ÏÑ±Í≥µÎ•† Í≥ÑÏÇ∞
            const successRate = recordsWithApe > 0 ? ((successfulImprovements / recordsWithApe) * 100).toFixed(1) : 0;
            
            return `
                <div class="chart-grid">
                    <div class="chart-stat">
                        <div class="chart-stat-value">${avgImprovement > 0 ? '+' : ''}${avgImprovement.toFixed(1)}%</div>
                        <div class="chart-stat-label">ÌèâÍ∑† Í∞úÏÑ†Ïú®</div>
                    </div>
                    <div class="chart-stat">
                        <div class="chart-stat-value">${recordsWithApe.toLocaleString()}</div>
                        <div class="chart-stat-label">APE Ï†ÅÏö© Î¨∏Ïû•</div>
                    </div>
                    <div class="chart-stat">
                        <div class="chart-stat-value">${successRate}%</div>
                        <div class="chart-stat-label">APE ÏÑ±Í≥µÎ•†</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3 style="margin-bottom: 16px; color: var(--text-primary); text-align: center;">APE Í∞úÏÑ† Ìö®Í≥º Î∂ÑÌè¨</h3>
                    ${recordsWithApe > 0 ? `
                    <div class="simple-chart">
                        ${improvementRanges.map(range => {
                            // ÏôÑÏ†ÑÌïú ÎπÑÎ°Ä Ïä§ÏºÄÏùºÎßÅ - ÏµúÏÜå ÎÜíÏù¥ ÏóÜÏùå
                            const maxCount = Math.max(...improvementRanges.map(r => r.count));
                            const height = maxCount > 0 ? (range.count / maxCount * 100) : 0;
                            // 0Ïù∏ Í≤ΩÏö∞ÏóêÎßå 1pxÎ°ú ÌëúÏãú (ÏôÑÏ†ÑÌûà ÏïàÎ≥¥Ïù¥ÏßÄ ÏïäÍ≤å)
                            const displayHeight = range.count === 0 ? 1 : height;
                            // ÌçºÏÑºÌä∏ Í≥ÑÏÇ∞
                            const percentage = recordsWithApe > 0 ? ((range.count / recordsWithApe) * 100).toFixed(1) : '0.0';
                            
                            // ÎîîÎ≤ÑÍπÖÏö© Î°úÍ∑∏
                            console.log(`APE Range ${range.range}: count=${range.count}, maxCount=${maxCount}, height=${height}%, displayHeight=${displayHeight}%`);
                            
                            return `
                                <div class="chart-bar">
                                    <div class="bar" style="height: ${displayHeight}%; background: ${range.color};">
                                        ${range.count > 0 ? `<div class="bar-value">${range.count.toLocaleString()}</div>` : ''}
                                    </div>
                                    <div class="bar-label" style="text-align: center;">
                                        ${range.range}<br>
                                        <span style="font-size: 11px; color: var(--text-muted);">${percentage}%</span><br>
                                        <span style="font-size: 10px; color: var(--text-muted); font-style: italic;">${range.description}</span>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    ` : `
                    <div style="text-align: center; padding: 40px; color: var(--text-muted);">
                        <div style="font-size: 48px; margin-bottom: 16px;">üìä</div>
                        <div style="font-size: 16px; margin-bottom: 8px;">APE Í∞úÏÑ† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§</div>
                        <div style="font-size: 14px;">APE(Automatic Post-Editing)Í∞Ä Ï†ÅÏö©Îêú Î†àÏΩîÎìúÍ∞Ä Î∞úÍ≤¨ÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.</div>
                    </div>
                    `}
                </div>
            `;
        }

        function generateDonutChart(data, total) {
            // Îπà Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨
            if (!data || data.length === 0 || total === 0) {
                return `<circle cx="100" cy="100" r="70" fill="none" stroke="#6b7280" stroke-width="3" opacity="0.3"/>
                       <text x="100" y="100" text-anchor="middle" dy=".3em" fill="#6b7280" font-size="12">Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå</text>`;
            }
            
            let cumulativeAngle = 0;
            const radius = 70;
            const innerRadius = 45;
            const centerX = 100;
            const centerY = 100;
            
            return data.filter(item => item.value > 0).map(item => {
                const angle = (item.value / total) * 360;
                const startAngle = cumulativeAngle;
                const endAngle = cumulativeAngle + angle;
                
                const x1 = centerX + radius * Math.cos((startAngle - 90) * Math.PI / 180);
                const y1 = centerY + radius * Math.sin((startAngle - 90) * Math.PI / 180);
                const x2 = centerX + radius * Math.cos((endAngle - 90) * Math.PI / 180);
                const y2 = centerY + radius * Math.sin((endAngle - 90) * Math.PI / 180);
                
                const x3 = centerX + innerRadius * Math.cos((endAngle - 90) * Math.PI / 180);
                const y3 = centerY + innerRadius * Math.sin((endAngle - 90) * Math.PI / 180);
                const x4 = centerX + innerRadius * Math.cos((startAngle - 90) * Math.PI / 180);
                const y4 = centerY + innerRadius * Math.sin((startAngle - 90) * Math.PI / 180);
                
                const largeArcFlag = angle > 180 ? 1 : 0;
                
                const pathData = [
                    `M ${x1} ${y1}`,
                    `A ${radius} ${radius} 0 ${largeArcFlag} 1 ${x2} ${y2}`,
                    `L ${x3} ${y3}`,
                    `A ${innerRadius} ${innerRadius} 0 ${largeArcFlag} 0 ${x4} ${y4}`,
                    'Z'
                ].join(' ');
                
                cumulativeAngle += angle;
                
                return `<path d="${pathData}" fill="${item.color}" stroke="var(--primary-bg)" stroke-width="2"/>`;
            }).join('');
        }

        function closeStatsModal() {
            const modal = document.getElementById('statsModal');
            modal.classList.remove('show');
        }

        // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠Ïãú Îã´Í∏∞
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('statsModal');
            if (event.target === modal) {
                closeStatsModal();
            }
        });

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
    </script>
</body>
</html>